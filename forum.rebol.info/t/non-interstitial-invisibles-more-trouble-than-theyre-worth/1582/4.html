<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Non-Interstitial Invisibles: More Trouble Than They&#39;re Worth? - #4 by hostilefork - Internals - AltRebol</title>
    <meta name="description" content="Invisibles are a novel and important concept.  But they introduce a lot of wrinkles. 
While there&amp;#39;s a lot of technical complexity--I&amp;#39;m not terribly worried about that (technical problems have technical solutions).  But u&amp;hellip;">
    <meta name="generator" content="Discourse 2.7.0.beta4 - https://github.com/discourse/discourse version 3fc72543de22c329cf2156f28b781821adc496ae">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/1X/cbd70027b53fa165575e5b665f00eb3b8ae7ea31_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../1582.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.rebol.info","potentialAction":{"@type":"SearchAction","target":"https://forum.rebol.info/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="AltRebol Search">

      <link href="https://forum.rebol.info/stylesheets/desktop_e71c7b3a0694e7f6434c54a663bfb42821f8bd81.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="desktop" />
    
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Non-Interstitial Invisibles: More Trouble Than They&#39;re Worth?&#39;" href="../1582.rss" />
    <meta property="og:site_name" content="AltRebol" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:url" content="https://forum.rebol.info/t/non-interstitial-invisibles-more-trouble-than-theyre-worth/1582/4" />
<meta name="twitter:url" content="https://forum.rebol.info/t/non-interstitial-invisibles-more-trouble-than-theyre-worth/1582/4" />
<meta property="og:title" content="Non-Interstitial Invisibles: More Trouble Than They&#39;re Worth?" />
<meta name="twitter:title" content="Non-Interstitial Invisibles: More Trouble Than They&#39;re Worth?" />
<meta property="og:description" content="Thinking on this particular issue made me realize that the way things work now, plain GROUP! being able to resolve to a value would be fine.  When a rule &quot;sees&quot; the product of a group, it&#39;s seeing it as the rule&#39;s value-bearing product, not as an inlined rule.  This is a completely new concept that works with block rules being value-bearing of their last value-bearing rule product...parallel to DO.  So at least this one pesky instance that had gotten into my head as a new class of problem isn&#39;t..." />
<meta name="twitter:description" content="Thinking on this particular issue made me realize that the way things work now, plain GROUP! being able to resolve to a value would be fine.  When a rule &quot;sees&quot; the product of a group, it&#39;s seeing it as the rule&#39;s value-bearing product, not as an inlined rule.  This is a completely new concept that works with block rules being value-bearing of their last value-bearing rule product...parallel to DO.  So at least this one pesky instance that had gotten into my head as a new class of problem isn&#39;t..." />
<meta property="article:published_time" content="2021-04-13T07:33:17+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="https://forum.rebol.info/">
          <img src="../../../uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" alt="AltRebol" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="../1582.html">Non-Interstitial Invisibles: More Trouble Than They&#39;re Worth?</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/development/8" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="../../../c/development/internals.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Internals</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../1582.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2021-04-12T16:40:45Z'>
              <time itemprop='dateModified' datetime='2021-04-12T17:15:27Z' class='post-time'>
                April 12, 2021,  5:15pm
              </time>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p><strong><a href="../../issues-with-invisibles-a-truly-disappearing-comment/405.html">Invisibles are a novel and important concept.</a></strong>  But they introduce a lot of wrinkles.</p>
<p>While there's a lot of technical complexity--I'm not terribly worried about that (technical problems have technical solutions).  But usability and semantic problems need to be confronted.</p>
<p>Early on, I wanted to avoid situations where an invisible could be in a position where it might look like it was an assignment:</p>
<pre><code>x: elide print "It's confusing when X gets [a]"
append [] 'a
</code></pre>
<p>Since the ELIDE vanished, the result of the APPEND is what X gets.  Confusing!</p>
<p>So at first, I figured it should be illegal to do that.  But I later backed off on ruling it out when I thought about a vanishing BREAKPOINT:</p>
<pre><code>x: breakpoint append [] 'a
</code></pre>
<p>Why shouldn't you be able to put a breakpoint wherever you want, I wondered?  So it became legal.</p>
<p><strong>Now I'm having serious second thoughts about the lenience.</strong>  I don't know this tradeoff is ultimately worth it; it becomes very slippery when you are dealing with constructs that you aren't necessarily noticing are invisible.  This problem feels like it gets worse in PARSE, if plain GROUP!s are invisible and people accidentally put them in slots where they think they are the value, but the value actually comes later:</p>
<pre><code>&gt;&gt; uparse [1 &lt;whoops&gt;] [return collect [
       keep integer! keep ("that was a number!") tag!
   ]]
== [1 &lt;whoops&gt;]
</code></pre>
<p>The person thought they were keeping a string literal in their rule.  But plain GROUP! is invisible, so they actually kept the rule <em>after</em> the string.  (They actually wanted <strong><code>keep @("that was a number!")</code></strong>)</p>
<p>Anyway, these situations are very much parallel.  So I'm thinking that the error on invisibility for non-interstitials (e.g. assignment sources or argument slots) may make sense...to say that invisibility is something that can only happen in interstitial locations.</p>
<p>You can still get your breakpoint at odd positions, just introduce a GROUP! so it's not picked up:</p>
<pre><code>x: (breakpoint append [] 'a)
</code></pre>
<p>Of course, a group might interfere with something like a COMPOSE, so you might need to use DO or be otherwise creative:</p>
<pre><code>x: do [breakpoint append [] 'a]
</code></pre>
<p>We might lament the need to worry more about restructuring the code to accommodate the breakpoint in ways that could disrupt the code.  But with dialecting, the appearance of the word BREAKPOINT even just in itself could have caused a disruption.  It's the cost of doing business in this paradigm.</p>
<h2>What might this imply for other cases, like <strong>do []</strong> ?</h2>
<p>It may suggest that <code>do []</code> can be invisible and vanish... just not have the result used in assignments.  Which might be perfect; if you get frustrated with that, you can always consciously put a value in-between.</p>
<p>So instead of:</p>
<pre><code>x: thing-that-might-be-invisible
</code></pre>
<p>You could say:</p>
<pre><code> x: (&lt;default-value&gt; thing-that-may-be-invisible)
</code></pre>
<p>There needs to be some way of specifically evaluating something and finding out if it was invisible...much like there needs to be a way of evaluating something and knowing if it threw, or raised an error, etc.  Not everything fits cleanly as a "result value".  But this shows there'd be at least one way of dealing with it besides that.</p>
        </div>

        <meta itemprop='headline' content='Non-Interstitial Invisibles: More Trouble Than They&#39;re Worth?'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                    <a href="../../core-evaluator-mechanics-complex-return-results/1590.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='https://forum.rebol.info/t/core-evaluator-mechanics-complex-return-results/1590'>
                      <span itemprop='name'>Core Evaluator Mechanics: Complex Return Results</span>
                    </a>
                    <meta itemprop='position' content='2'>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../1582.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-04-13T01:36:53Z' class='post-time'>
                April 13, 2021,  1:36am
              </time>
              <meta itemprop='dateModified' content='2021-04-13T01:36:53Z'>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="hostilefork" data-post="1" data-topic="1582">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/hostilefork/40/26_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<p>Anyway, these situations are very much parallel. So I'm thinking that the error on invisibility for non-interstitials (e.g. assignment sources or argument slots) may make sense...to say that invisibility is something that can only happen in interstitial locations.</p>
</blockquote>
</aside>
<p>Well, this neglects at least one important case today:</p>
<pre><code>if let pos: find series item [...]
</code></pre>
<p>Currently, LET followed by a SET-WORD! or a SET-BLOCK! adds a binding and vanishes, leaving the existing code to run as it would.  This helps make sure it doesn't disrupt any special processing, e.g. looking backwards at the SET-WORD! (think <strong>x: me + 1</strong>, which we want to work the same as <strong>let x: me + 1</strong>, hence LET should be staying out of the assignment logic done by ME by quoting backwards).</p>
<p>If followed by a WORD!, LET does something different, it consumes the word and evalutes to that WORD!</p>
<pre><code>if let x [...]
</code></pre>
<p>That would act something like:</p>
<pre><code>if 'x [...]  ; the X is a new binding, with that binding visible to ensuing code
</code></pre>
<p>It's useful when you want to pass a new variable in as a parameter to something.  Not particularly useful in this case, but that's what it would be.</p>
<p>This demonstrates what I've called "opportunistic invisibility"... which offers a MACRO-like ability to expand to some content or no content.</p>
<p>So anyway... not so simple.  <strong>Maybe this suggests that the act of vanishing is distinct from the act of delegating/forwarding to another expression, e.g. a MACRO?</strong></p>
<p>e.g. maybe LET is legal in a condition argument slot because it's saying something different from "I vanish".  It's saying <em>"I am twisting the evaluation feed and supplying new content to take the place of the expression that belongs here"</em>.</p>
<p>Hence how LET with a SET-WORD! works is not invisibility...rather that it actually binds and evaluates one expression forward, and then puts in its place the result of quoting the result of that expression.</p>
<h2>Another Question: Should Macros Replace Invisibles?</h2>
<p>Invisible functions are hard to understand, whereas with generic quoting it can be pretty efficient to make macros that splice quoted material.</p>
<pre><code>m: macro [invisible [logic!]] [
    if invisible [return []]
    return ['invisible]
]

&gt;&gt; 10 m false
== invisible

&gt;&gt; 10 m true
== 10
</code></pre>
<p><em>(Note: there's some bug on this at present, but it's supposed to work.)</em></p>
<p>Given that invisibility causes so many technical problems, might it be better to have a separate MACRO! type that encodes the capability of being invisible at all (just splice an empty block)?</p>
<p>Then we could say it's invisible macros that are prohibited in non-interstitial slots; and LET would be a macro that's never actually be invisible, e.g.:</p>
<pre><code>if let pos: find series item [...]
</code></pre>
<p>=&gt; splices [pos: find series item] as macro result</p>
<pre><code>if pos: find series item [...]
</code></pre>
<p>One has to look at the concrete scenarios to see how much of this is just pushing terminology around and what breaks.  If there's a new datatype called MACRO! with distinct properties from ACTION! you start having to pay a mental tax of which you're working with... is it legal to DO a macro in isolation, etc.</p>
<p>Maybe I'm worrying about too much and we just have to accept the potential failures like:</p>
<pre><code>&gt;&gt; uparse [1 &lt;whoops&gt;] [return collect [
       keep integer! keep ("that was a number!") tag!
   ]]
== [1 &lt;whoops&gt;]
</code></pre>
<p>But I want to point these things out so whatever decisions are being made are conscious ones.</p>
        </div>

        <meta itemprop='headline' content='Non-Interstitial Invisibles: More Trouble Than They&#39;re Worth?'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='../../../u/IngoHohmann.html'><span itemprop='name'>IngoHohmann</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../1582.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-04-13T07:23:55Z' class='post-time'>
                April 13, 2021,  7:23am
              </time>
              <meta itemprop='dateModified' content='2021-04-13T07:23:55Z'>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I could live with breakpoint being the only special invisible, that can be put everywhere, but I'm not sure whether it's worth the hassle.</p>
        </div>

        <meta itemprop='headline' content='Non-Interstitial Invisibles: More Trouble Than They&#39;re Worth?'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../1582.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2021-04-13T07:33:17Z'>
              <time itemprop='dateModified' datetime='2021-04-13T07:34:07Z' class='post-time'>
                April 13, 2021,  7:34am
              </time>
          <span itemprop='position'>#4</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="hostilefork" data-post="2" data-topic="1582">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/hostilefork/40/26_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<p>Maybe I'm worrying about too much and we just have to accept the potential failures like:</p>
<pre><code>&gt;&gt; uparse [1 &lt;whoops&gt;] [return collect [
       keep integer! keep ("that was a number!") tag!
   ]]
== [1 &lt;whoops&gt;]
</code></pre>
</blockquote>
</aside>
<p>Thinking on this particular issue made me realize that the way things work now, plain GROUP! being able to resolve to a value would be fine.</p>
<p>When a rule "sees" the product of a group, it's seeing it as the rule's <em>value-bearing product</em>, not as an inlined rule.  This is a completely new concept that works with <a href="../../separating-parse-rules-across-contexts/313/5.html">block rules being value-bearing of their last value-bearing rule product</a>...parallel to DO.</p>
<p>So at least this one pesky instance that had gotten into my head as a new class of problem isn't as pesky.   You get:</p>
<pre><code>&gt;&gt; uparse [1 &lt;whoops&gt;] [return collect [
       keep integer! keep ("that was a number!") tag!
   ]]
== [1 "that was a number!"]
</code></pre>
<p>I'll keep thinking on it for other potential problem cases.</p>
        </div>

        <meta itemprop='headline' content='Non-Interstitial Invisibles: More Trouble Than They&#39;re Worth?'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/categories' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/guidelines' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  
</html>
