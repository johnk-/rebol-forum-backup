<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Treat BLANK!s from Variables or Evaluation Like NULL - Dialects/DSLs - AltRebol</title>
    <meta name="description" content="BLANK! has a very tempting nature to make you want to use it to mean something.  For instance, I&amp;#39;ve consistently wanted it to mean space in DELIMIT&amp;#39;s &amp;quot;dialect&amp;quot; : 
write port unspaced [
    &amp;quot;HTTP/1.0&amp;quot; _ code _ code-map/:c&amp;hellip;">
    <meta name="generator" content="Discourse 2.7.0.beta4 - https://github.com/discourse/discourse version 3fc72543de22c329cf2156f28b781821adc496ae">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/cbd70027b53fa165575e5b665f00eb3b8ae7ea31_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="1348.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.rebol.info","potentialAction":{"@type":"SearchAction","target":"https://forum.rebol.info/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="AltRebol Search">

      <link href="https://forum.rebol.info/stylesheets/desktop_e71c7b3a0694e7f6434c54a663bfb42821f8bd81.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="desktop" />
    
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Treat BLANK!s from Variables or Evaluation Like NULL&#39;" href="1348.rss" />
    <meta property="og:site_name" content="AltRebol" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:url" content="https://forum.rebol.info/t/treat-blank-s-from-variables-or-evaluation-like-null/1348" />
<meta name="twitter:url" content="https://forum.rebol.info/t/treat-blank-s-from-variables-or-evaluation-like-null/1348" />
<meta property="og:title" content="Treat BLANK!s from Variables or Evaluation Like NULL" />
<meta name="twitter:title" content="Treat BLANK!s from Variables or Evaluation Like NULL" />
<meta property="og:description" content="BLANK! has a very tempting nature to make you want to use it to mean something.  For instance, I&#39;ve consistently wanted it to mean space in DELIMIT&#39;s &quot;dialect&quot; :  write port unspaced [     &quot;HTTP/1.0&quot; _ code _ code-map/:code CR LF     &quot;Content-type:&quot; _ type CR LF     &quot;Content-length:&quot; _ (length of body) CR LF     CR LF ]  That is awesome.  It lets you see what&#39;s going on very clearly.  I&#39;m always annoyed when people include spacing in the edges of the things being spaced, like &quot;HTTP/1.0 &quot; ... bec..." />
<meta name="twitter:description" content="BLANK! has a very tempting nature to make you want to use it to mean something.  For instance, I&#39;ve consistently wanted it to mean space in DELIMIT&#39;s &quot;dialect&quot; :  write port unspaced [     &quot;HTTP/1.0&quot; _ code _ code-map/:code CR LF     &quot;Content-type:&quot; _ type CR LF     &quot;Content-length:&quot; _ (length of body) CR LF     CR LF ]  That is awesome.  It lets you see what&#39;s going on very clearly.  I&#39;m always annoyed when people include spacing in the edges of the things being spaced, like &quot;HTTP/1.0 &quot; ... bec..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="2 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="1 ❤" />
<meta property="article:published_time" content="2020-09-27T05:47:05+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="https://forum.rebol.info/">
          <img src="../../uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" alt="AltRebol" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="1348.html">Treat BLANK!s from Variables or Evaluation Like NULL</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/domains/15" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #F1592A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Domains</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/domains/dialects-dsls/18" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #F1592A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Dialects/DSLs</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="1348.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2020-09-27T05:47:05Z'>
              <time itemprop='dateModified' datetime='2020-09-27T13:13:10Z' class='post-time'>
                September 27, 2020,  1:13pm
              </time>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>BLANK! has a very tempting nature to make you want to use it to <em>mean something</em>.  For instance, I've consistently wanted it to mean <code>space</code> in DELIMIT's "dialect" :</p>
<pre><code>write port unspaced [
    "HTTP/1.0" _ code _ code-map/:code CR LF
    "Content-type:" _ type CR LF
    "Content-length:" _ (length of body) CR LF
    CR LF
]
</code></pre>
<p><strong>That is awesome.</strong>  It lets you see what's going on very clearly.  I'm always annoyed when people include spacing in the edges of the things being spaced, like <code>"HTTP/1.0 "</code> ... because it makes it harder to factor.  It also makes it hard to see what's a string and what's not:</p>
<pre><code> print [" At a " glance " how " do " you tell " whats " a string "]
</code></pre>
<p><strong>But as awesome as BLANK!-spacing is, it has a downside.</strong>  It sucks if a variable holds BLANK! with the intent to mean <em>nothing</em> if that <em>nothing</em> becomes a space character.</p>
<p>As a simple example to demonstrate, let's say you've got a situation like this where the second item is supposed to be "not there":</p>
<pre><code>values: ["one" _ &lt;three&gt;]

print "And here the values are!"
for-each item values [
    print [item]
]
</code></pre>
<p>Clever mechanics in PRINT and SPACED won't print lines that fully vaporize.  So if that values/2 were an actual NULL, you'd get just the two lines printing...with no newline between them.</p>
<p>But BLANK! acts as a space.  So instead, you get something that's actually worse than it looks:</p>
<pre><code>And here the values are!
one

&lt;three&gt;
</code></pre>
<p>I say it's worse because that empty line isn't actually empty.  <em>It actually wrote a space and a newline.</em></p>
<p>You physically cannot put NULLs in BLOCK!s.  And branches have become more involved with turning NULLs into voids to signal when a branch ran (some creative tools to deal with that coming soon).  So it becomes a juggling act to switch back and forth between null and blank when you might consider it easier for your purposes to stick with blank for some things.</p>
<h2>Why Not Try Differentiating Evaluated BLANK! vs. Literal?</h2>
<pre><code>&gt;&gt; print ["a" _ "b"]
a b

&gt;&gt; var: _
&gt;&gt; print ["a" var "b"]
ab
</code></pre>
<p>Well... <em>OF COURSE that was tried.</em>  Multiple forms of PRINT and DELIMIT over time have experimented with subtly different rules to try and find a sweet spot.</p>
<p>But you should be careful in dialects where replacing a literal with a variable gives a different effect.  In particular, this was noticed with BLOCK!s...where the behavior felt very unpredictable when an in-place block did something different from one accessed through a variable:</p>
<pre><code>&gt;&gt; print [["doesn't" "space"] "does" "space"]
doesn'tspace does space

&gt;&gt; block: ["doesn't" "space"]
&gt;&gt; print [block "does" "space"]
doesn't space does space
</code></pre>
<p>Some historical examples in this vein were tried and discarded.  It seemed to run against the idea of being able to abstract what you were writing.</p>
<p>You can think of other examples like this.  What if PARSE decided that an in-place integer meant a count, but one through a word! matched the number?</p>
<pre><code>&gt;&gt; did parse "aa" [2 "a"]
== #[true]

&gt;&gt; count: 2
&gt;&gt; did parse "aa" [count "a"]
== #[false]

&gt;&gt; did parse [2] [count]
== #[true]
</code></pre>
<p>It doesn't do "double execution" of WORD!s that contain WORD!s.  But static data is substituted as-is, including BLOCK!.  So what is BLANK! more like...?</p>
<h2>I Think BLANK! is Special, and We Have QUOTED! Tools Now</h2>
<p>The subject of this post sums up how I think the competing demands on BLANK! should be resolved:</p>
<p><strong>You should treat BLANK! the same way you would treat a NULL if you fetch it from a variable or an evaluation.  But if it's at "source-level" you can give it another meaning, to take advantage of its unique visual properties.  If it has no meaning at source level, a literal BLANK! should raise an error.</strong></p>
<p><em>(Here I'm going so far as to say that you nearly <em>shouldn't</em> let a source-level blank mean the same thing as a fetched null in your dialect.   Maybe that's not necessarily a good rule...but there's something giving me an inkling that it might be.)</em></p>
<p>You might point out that the definition of "source-level" is slippery, as people can be COMPOSE-ing code together.  But when you compose, you'll have issues with WORD! as well:</p>
<pre><code>&gt;&gt; foo: void
&gt;&gt; var: 'foo
&gt;&gt; print ["a" var "b]
a foo b

&gt;&gt; print compose ["a" (var) "b"]
** Script Error: foo is VOID! (Note: use GET/ANY to GET voids)
</code></pre>
<p>But the same quoting tool that can help with this can help with BLANK!, because quoted blanks are evaluated (all the evaluation does is drop the quote, but it's still evaluation)</p>
<pre><code>&gt;&gt; foo: void
&gt;&gt; var: 'foo
&gt;&gt; print compose ["a" '(var) "b"]
a foo b

&gt;&gt; print ["a" _ "b"]
a b

&gt;&gt; print ["a" '_ "b"]
ab

&gt;&gt; var: _
&gt;&gt; print ["a" '(var) "b"]
ab
</code></pre>
<h2>This Feels Like Solid Guidance</h2>
<p>I think this is pretty much as good as it gets.  Like I say, it pays to be cautious when making substitutions of values behave differently than if they appeared literally...but this seems to work.</p>
<p>It does have some kind of strange implications for PARSE and BLANK!.  We know that QUOTED! means match directly:</p>
<pre><code>&gt;&gt; did parse [1 _ 'x] ['1 '_ ''x]
== #[true]
</code></pre>
<p>And if you fetch out of a variable you're supposed to treat it as if it's not there:</p>
<pre><code>&gt;&gt; rule: _
&gt;&gt; did parse "abcd" ["ab" rule "cd"]
== #[true]
</code></pre>
<p>So would it be acceptable to let the literal form mean "skip"?</p>
<pre><code>&gt;&gt; did parse [1 &lt;foo&gt; "hi"] [integer! _ text!]
== #[true]
</code></pre>
<p>I think that's within the rules, and can be a design choice.  The key is just that when it comes from a variable, it has to act the same as null.  What you do in your dialect with quoted forms that are literal is as much up to you as what you do with the plain forms.</p>
<p>Hopefully this resolves a couple of years-old questions:</p>
<pre><code>&gt;&gt; rule: _
== _

&gt;&gt; parse [a b _ _ _] ['a 'b 3 rule]
== [_ _ _]  ; residual

&gt;&gt; rule: quote _
== '_

&gt;&gt; parse [a b _ _ _] ['a 'b 3 rule]
== []  ; all parsed
</code></pre>
<p>What's nice is that QUOTE gives you a generic way to turn a value you want to match into a value you know will work in the parse.  Without generic quoting you wouldn't have it!  It's a little bit easier to look at than:</p>
<pre><code>&gt;&gt; rule: ''_
== '_</code></pre>
        </div>

        <meta itemprop='headline' content='Treat BLANK!s from Variables or Evaluation Like NULL'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/categories' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/guidelines' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  
</html>
