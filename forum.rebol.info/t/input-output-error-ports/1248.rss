<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Input/Output/Error Ports</title>
    <link>https://forum.rebol.info/t/input-output-error-ports/1248</link>
    <description>A fundamental Rebol 2 feature lacking from Rebol 3 (and by extension, Ren-C) is the concept of Input/Output ports (and missing from Rebol 2 was an Error port).

In Rebol 2, the Console scheme was used for both Input/Output when the interpreter was invoked without argument (thus entering the REPL loop), whereas when invoked with argument (at least on Mac/Linux), Input/Output used the File scheme on what I assume to be a virtual file.

That Rebol 3 uses the Console scheme for Input and no scheme (or port) for output reveal some limitiations, such as the bleeding of console logic and decoration in shell scripts, or redirecting output to a hard file, and the awkward workaround that is WRITE-STDOUT. The first case there is especially notable for me as I primarily develop and deploy scripts as shell scripts and the Console scheme should never be a consideration in that mode.

I understand that the whole Port model could use a fair degree of scrutiny—and I certainly can&#39;t speak to the rectitude of using FILE as the default I/O scheme (I don&#39;t have that systemic understanding), but it seems that the long arc of Rebol 3/Ren-C development has kind-of skirted this core concern.</description>
    
    <lastBuildDate>Mon, 16 Dec 2019 20:02:05 +0000</lastBuildDate>
    <category>Ports</category>
    <atom:link href="https://forum.rebol.info/t/input-output-error-ports/1248.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Input/Output/Error Ports</title>
        <dc:creator><![CDATA[rgchris]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="9" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/hostilefork/40/26_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<p>I am pretty much at 100% on understanding what is there, and I've not been shy about saying the emperor has no clothes.</p>
</blockquote>
</aside>
<p>I still don't fully appreciate this assertion—ports and schemes are how we interact with the outside world—why wouldn't that encompass the relationship with STDIN/OUT/ERR as opposed to black-box functions?</p>
          <p><a href="https://forum.rebol.info/t/input-output-error-ports/1248/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.rebol.info/t/input-output-error-ports/1248/10</link>
        <pubDate>Mon, 16 Dec 2019 20:02:05 +0000</pubDate>
        <guid isPermaLink="false">forum.rebol.info-post-1248-10</guid>
        <source url="https://forum.rebol.info/t/input-output-error-ports/1248.rss">Input/Output/Error Ports</source>
      </item>
      <item>
        <title>Input/Output/Error Ports</title>
        <dc:creator><![CDATA[hostilefork]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="8" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/rgchris/40/14_2.png" class="avatar"> rgchris:</div>
<blockquote>
<p><strong>print "Stuff"</strong> doesn't error, but <strong>insert system/ports/output "Stuff"</strong> does</p>
</blockquote>
</aside>
<p>I am pretty much at 100% on understanding what is there, and I've not been shy about saying the emperor has no clothes.</p>
<p>But...if you say "I need X" I will do it.  Seems you are getting interested again, and I will do as you wish.  File issues, and you will see results.</p>
          <p><a href="https://forum.rebol.info/t/input-output-error-ports/1248/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.rebol.info/t/input-output-error-ports/1248/9</link>
        <pubDate>Mon, 16 Dec 2019 16:29:30 +0000</pubDate>
        <guid isPermaLink="false">forum.rebol.info-post-1248-9</guid>
        <source url="https://forum.rebol.info/t/input-output-error-ports/1248.rss">Input/Output/Error Ports</source>
      </item>
      <item>
        <title>Input/Output/Error Ports</title>
        <dc:creator><![CDATA[rgchris]]></dc:creator>
        <description><![CDATA[
            <p>If you are using the Rebol 2 REPL and say <strong>close system/ports/output</strong>, the REPL still works, you just don't see any output. This seems fine and predictable to me, it's what you'd expect when you close the output port. It should maybe error on trying to write to a closed port, but how would you know**? <img src="https://forum.rebol.info/images/emoji/twitter/slight_smile.png?v=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>I don't think the interpreter should protect you from making dumb choices like this, but I don't think anyone will accidentally do so. In Ren-C currently, the 'console scheme is a black box—bad things happen if you change the <strong>system/ports/input/actor</strong> value</p>
<p>**(<strong>print "Stuff"</strong> doesn't error, but <strong>insert system/ports/output "Stuff"</strong> does)</p>
          <p><a href="https://forum.rebol.info/t/input-output-error-ports/1248/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.rebol.info/t/input-output-error-ports/1248/8</link>
        <pubDate>Sat, 07 Dec 2019 02:41:09 +0000</pubDate>
        <guid isPermaLink="false">forum.rebol.info-post-1248-8</guid>
        <source url="https://forum.rebol.info/t/input-output-error-ports/1248.rss">Input/Output/Error Ports</source>
      </item>
      <item>
        <title>Input/Output/Error Ports</title>
        <dc:creator><![CDATA[rgchris]]></dc:creator>
        <description><![CDATA[
            <p>I think the better name for an <strong>output</strong> scheme when in REPL mode is 'terminal *.</p>
<p>I'm fine with <strong>system/ports/output</strong> being a monolith—I should say, at this point I'd advocate simply for the Rebol 2 model where the 'console scheme-based input port waits and processes input and I presume uses <strong>prin(t)</strong> as the conduit to the output port. I'm not certain what the merits are of sending <code>&gt;&gt;</code> or <code>==</code> to a different port than <code>&lt;result&gt;</code>. I would, of course, deviate from Rebol 2 in putting as much of that scheme in user-mode as is possible.</p>
<p>If you happen to redirect output to a 'file scheme, then it's on you to monitor when an error occurs—again, as per the Rebol 2 model.</p>
<p>It's also conceivable that <strong>system/ports/output</strong> and <strong>system/ports/error</strong> could point to <em>the same port</em>—I'm less concerned about how that works in the REPL environment (where you'd presumably wish to see errors and output appear in the same place) than being able to fine-grain your responses when invoked as a shell script (which goes hand-in-hand with being able to set your own exit status) or with a script argument.</p>
<p>*A 'terminal scheme might include the ability to detect console-like output and interject some terminal codes on select systems, as an example.</p>
<p>My goal here is to avoid the console and trappings altogether unless I'm explicitly using the REPL.</p>
          <p><a href="https://forum.rebol.info/t/input-output-error-ports/1248/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.rebol.info/t/input-output-error-ports/1248/7</link>
        <pubDate>Sat, 07 Dec 2019 02:37:56 +0000</pubDate>
        <guid isPermaLink="false">forum.rebol.info-post-1248-7</guid>
        <source url="https://forum.rebol.info/t/input-output-error-ports/1248.rss">Input/Output/Error Ports</source>
      </item>
      <item>
        <title>Input/Output/Error Ports</title>
        <dc:creator><![CDATA[hostilefork]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="5" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/rgchris/40/14_2.png" class="avatar"> rgchris:</div>
<blockquote>
<p>On reflection, the output port is somewhat trivial (your above qualms aside)</p>
</blockquote>
</aside>
<p>If you're interested in hooking the standard out, the console's perspective on it can have a wide variety of what you want to hook.  Do you want the console's prompt printing to the same place that your script code is outputting to?  If you do this by simple assignment to <code>system/standard/output</code>, then what happens if you hit an error in mid-script...who puts it back?  <img src="https://forum.rebol.info/images/emoji/twitter/bomb.png?v=9" title=":bomb:" class="emoji" alt=":bomb:"></p>
<p>I did some work on an ECHO feature which tried to push on some of those questions, and I think was pretty neat.  But it is mothballed for now, because there's just so much to do:</p>
<aside class="quote quote-modified" data-post="1" data-topic="1157">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="/user_avatar/forum.rebol.info/hostilefork/40/26_2.png" class="avatar">
    <a href="https://forum.rebol.info/t/echo-off-e-g-for-now-no-echo-feature/1157">ECHO OFF (e.g. for now, no ECHO feature)</a> <a class="badge-wrapper  bullet" href="/c/domains/console-development"><span class="badge-category-parent-bg" style="background-color: #F1592A;"></span><span class="badge-category-bg" style="background-color: #F1592A;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Specific development relating to the console, and driving the same.">Console Development</span></a>
  </div>
  <blockquote>
    Internally to R3-Alpha there was some code for implementing an ECHO feature, (a command which <a href="http://www.rebol.com/docs/words/wecho.html" rel="nofollow noopener">existed in Rebol2</a>).  This was something where you could capture the standard output of your interactive session to a file. 
It was one of those things that was hard to keep working... that didn't have any tests... so one didn't know what "working" was in the first place.  What were the expectations?  If all you have are hooks underneath the PORT! level in C code, that's going to lead to some strange log…
  </blockquote>
</aside>

<p>It seems a good start for a discussion of what's important.  I'm pretty sure it's rare for features or compositions you don't plan for to just work "by accident"...</p>
          <p><a href="https://forum.rebol.info/t/input-output-error-ports/1248/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.rebol.info/t/input-output-error-ports/1248/6</link>
        <pubDate>Sat, 07 Dec 2019 02:00:51 +0000</pubDate>
        <guid isPermaLink="false">forum.rebol.info-post-1248-6</guid>
        <source url="https://forum.rebol.info/t/input-output-error-ports/1248.rss">Input/Output/Error Ports</source>
      </item>
      <item>
        <title>Input/Output/Error Ports</title>
        <dc:creator><![CDATA[rgchris]]></dc:creator>
        <description><![CDATA[
            <p>On reflection, the output port is somewhat trivial (your above qualms aside). I feel if you're the type of user that would change <strong>system/ports/output</strong> then you'd accept any quirks in setting it to something that doesn't make sense (such as a closed port). I am partial to having the canonical values within <strong>system/ports</strong> as <strong>system</strong> would seem the home for such things, but having STDIN/STDOUT/STDERR as synonyms would also make sense.</p>
<p>I see the console scheme-based <strong>system/ports/input</strong> as the broker for the console-isms and where the non-trivial event handling would happen.</p>
          <p><a href="https://forum.rebol.info/t/input-output-error-ports/1248/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.rebol.info/t/input-output-error-ports/1248/5</link>
        <pubDate>Sat, 07 Dec 2019 01:17:12 +0000</pubDate>
        <guid isPermaLink="false">forum.rebol.info-post-1248-5</guid>
        <source url="https://forum.rebol.info/t/input-output-error-ports/1248.rss">Input/Output/Error Ports</source>
      </item>
      <item>
        <title>Input/Output/Error Ports</title>
        <dc:creator><![CDATA[hostilefork]]></dc:creator>
        <description><![CDATA[
            <blockquote>
<p>in Rebol 2, you could say:  <strong>system/ports/output: open %some/file</strong>  and that is where PRINT's output would end up</p>
</blockquote>
<p>That's the kind of thing I meant, when I said having things in usermode would certainly make that possible...trivially, even.  We <em>could</em> go through the step where STDOUT is a port, and defaulted <code>system/ports/output</code> to that port...then the PRINT code could simply be changed to use WRITE SYSTEM/PORTS/OUTPUT.  It would then work as you describe.</p>
<p><em>(Notably, if you said <code>system/ports/output: %some/file</code> and did not use <code>open</code>, then each PRINT statement would rewrite the file.  This may or may not raise semantic issues of if WRITE should always assume it's appending to what's there, and you have to <strong>delete</strong> it beforehand otherwise.  Or maybe there would need to be some kind of type trigger that would prevent modifications to <code>system/ports/output</code> that wasn't a PORT!...?  Questions...)</em></p>
<p>My own wish would be to ergonomically flip it.  It seems laborious for the average author to have to say <strong>write system/ports/output "&gt;&gt;"</strong> to get the indirection.  I'd rather they say <strong>write stdout "&gt;&gt;"</strong> and get the appropriate indirection, shared with whatever PRINT sees.</p>
<p>...but I don't know how to do that with your assignment model, because saying <strong>stdout: xxx</strong> can't currently change the stdout that the PRINT in the lib context sees.  You have to say at minimum <strong>sys/stdout: xxx</strong> to get them on the same page of changing the same context.  It changes if you say <strong>stdout/set-target xxx</strong> which then gives you the ability to change a property of a common object.</p>
<p>If it would make you happy enough to code more for now, we can copy Rebol2's model...and it can be how things are done until something better comes along.  I don't have a problem changing PRINT to WRITE to <code>system/ports/output</code> and make STDOUT a PORT! that's the default place it writes to.  Then add STDERR that similarly defaults to <code>system/ports/error</code>.</p>
<p>We would make WRITE-STDOUT a specialization of WRITE to <code>system/ports/output</code> so it saves some typing.  That could compromise between what I'd like to see and getting the indirection, and would be no worse than what's there today.  Though that notably brings out the example of a specialization that does <em>not</em> want to capture a value... since you want it to see changes.  You'd have to write it as:</p>
<pre><code>write-stdout: adapt (specialize 'write [destination: &lt;to-be-overwritten&gt;]) [
    destination: system/ports/output
]
</code></pre>
<p>So the specialization removes the parameter and sets it to garbage, then the adaptation injects prelude code on each run to fetch another value.  This "dynamic specialization" pattern is something I've been looking to see how to make easier.  But...at least it is possible.</p>
          <p><a href="https://forum.rebol.info/t/input-output-error-ports/1248/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.rebol.info/t/input-output-error-ports/1248/4</link>
        <pubDate>Sat, 07 Dec 2019 00:57:08 +0000</pubDate>
        <guid isPermaLink="false">forum.rebol.info-post-1248-4</guid>
        <source url="https://forum.rebol.info/t/input-output-error-ports/1248.rss">Input/Output/Error Ports</source>
      </item>
      <item>
        <title>Input/Output/Error Ports</title>
        <dc:creator><![CDATA[rgchris]]></dc:creator>
        <description><![CDATA[
            <p>This is where I start getting lost in the weeds a bit.</p>
<p>I'm not sure how the console scheme in Rebol 2 is formulated—seemingly <strong>system/ports/input</strong> and <strong>system/ports/output</strong> both use the console scheme when in REPL mode, but they are not the same port value so couldn't say what the relationship is or how they interact. I get the impression that the <strong>input</strong> port does most of the heavy lifting, <strong>output</strong> being a dumb 'print to terminal' affair.</p>
<p>A quick test at the Rebol 2 REPL shows that you can close and reopen <strong>system/ports/output</strong> without fuss, or switch it out for a different port! value. There are most certainly issues closing <strong>system/ports/input</strong>.</p>
<pre><code class="lang-auto">&gt;&gt; close system/ports/output
close system/ports/input 
Segmentation fault: 11
</code></pre>
<p>I similarly don't know if the file scheme maps to the way OS/Shell handles I/O, so don't know whether that was an appropriate choice or a hack.</p>
<p>The PRINT example is sound in itself, but is a level of abstraction above what I have in mind. It's more that WRITE-STDOUT is a black box stand-in where the elegance of the port concept should be. I don't necessarily see PRINT as relating to STDERR, rather just being shorthand for <strong>write system/ports/output "Stuff"</strong> with added compositional qualities—in Rebol 2, you could say: <strong>system/ports/output: open %some/file</strong> and that is where PRINT's output would end up. I suppose there could be <strong>print/error</strong> that would change the target to a proposed <strong>system/ports/error</strong>, but may be better handing off to a <strong>dump</strong> (or such) counterpart.</p>
<p>I do have a sense that solving this will lead to some better design outcomes.</p>
          <p><a href="https://forum.rebol.info/t/input-output-error-ports/1248/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.rebol.info/t/input-output-error-ports/1248/3</link>
        <pubDate>Sat, 07 Dec 2019 00:32:55 +0000</pubDate>
        <guid isPermaLink="false">forum.rebol.info-post-1248-3</guid>
        <source url="https://forum.rebol.info/t/input-output-error-ports/1248.rss">Input/Output/Error Ports</source>
      </item>
      <item>
        <title>Input/Output/Error Ports</title>
        <dc:creator><![CDATA[hostilefork]]></dc:creator>
        <description><![CDATA[
            <p>I'd be amenable to replacing WRITE-STDOUT with WRITE STDOUT...and adding the capability for WRITE STDERR even if those "PORT!s" are done by hook or by crook for now.  You'd be a good source of feedback for which messages in the system should be going where, given practical CSS scenarios.</p>
<aside class="quote no-group" data-post="1" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/rgchris/40/14_2.png" class="avatar"> rgchris:</div>
<blockquote>
<p>it seems that the long arc of Rebol 3/Ren-C development has kind-of skirted this core concern.</p>
</blockquote>
</aside>
<p>I feel the concern has been heeded in the sense that things are being built out of parts in a clear way.  For instance, the source for PRINT:</p>
<pre><code>print: func* [
    {Textually output spaced line (evaluating elements if a block)}

    return: "NULL if blank input or effectively empty block, otherwise VOID!"
        [&lt;opt&gt; void!]
    line "Line of text or block, blank or [] has NO output, newline allowed"
        [&lt;blank&gt; char! text! block!]
][
    if char? line [
        if not equal? line newline [
            fail "PRINT only allows CHAR! of newline (see WRITE-STDOUT)"
        ]
        return write-stdout line
    ]

    (write-stdout try spaced line) then [write-stdout newline]
]
</code></pre>
<p>This pushes into plain view exactly where the decision of where PRINT happens is made.  And it shows the logic of things in reusable parts.  PRINT is clearly based on SPACED, which is based on DELIMIT, etc.  But when things are packed into natives and circuitous code like R3-Alpha's I/O was done...especially in its "PORT!s", I'd definitely challenge anyone to make headway on a better design.</p>
<p>Just speaking up for the idea of whether this has been weighed as a serious consideration.  It has.  Of course you've still got questions like how PRINT would be parameterized to write to STDERR instead of STDOUT (if it can be at all).  But the parts are there so anyone who can write Rebol can participate in that design.</p>
<hr>
<p>One thing I've wanted to do is to get all of the cursor control and line editing / history logic into usermode.  Right now we have a bunch of <a href="https://github.com/metaeducation/ren-c/blob/8f0dd1347b38958c0dff5c8e36256148eaf3de15/extensions/stdio/readline-posix.c#L679" rel="nofollow noopener">twisty POSIX C based on termios</a>...which gives full control but hides everything (like the line history) in C code.  Then there's a <a href="https://github.com/metaeducation/ren-c/blob/8f0dd1347b38958c0dff5c8e36256148eaf3de15/extensions/stdio/stdio-windows.c#L359" rel="nofollow noopener">single monolithic call to ReadLine on Windows</a>, which offers absolutely no control and prevents the implementation of even simple features like <a href="https://github.com/metaeducation/ren-c/issues" rel="nofollow noopener">tab for file completion</a>.</p>
<p>It may not sound like a huge priority... but... sorting this out for the Web REPL <em>is</em> a priority.  And it would be nice if the same customizations would run on all platforms, because a console port was abstract enough to handle the features nicely across all three.</p>
<p>And in sorting that out, a graceful fallback to having fewer and fewer features for I/O is important to have.  CGI is a good example of this.</p>
          <p><a href="https://forum.rebol.info/t/input-output-error-ports/1248/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.rebol.info/t/input-output-error-ports/1248/2</link>
        <pubDate>Fri, 06 Dec 2019 22:26:46 +0000</pubDate>
        <guid isPermaLink="false">forum.rebol.info-post-1248-2</guid>
        <source url="https://forum.rebol.info/t/input-output-error-ports/1248.rss">Input/Output/Error Ports</source>
      </item>
      <item>
        <title>Input/Output/Error Ports</title>
        <dc:creator><![CDATA[rgchris]]></dc:creator>
        <description><![CDATA[
            <p>A fundamental Rebol 2 feature lacking from Rebol 3 (and by extension, Ren-C) is the concept of Input/Output ports (and missing from Rebol 2 was an Error port).</p>
<p>In Rebol 2, the Console scheme was used for both Input/Output when the interpreter was invoked without argument (thus entering the REPL loop), whereas when invoked with argument (at least on Mac/Linux), Input/Output used the File scheme on what I assume to be a virtual file.</p>
<p>That Rebol 3 uses the Console scheme for Input and no scheme (or port) for output reveal some limitiations, such as the bleeding of console logic and decoration in shell scripts, or redirecting output to a hard file, and the awkward workaround that is WRITE-STDOUT. The first case there is especially notable for me as I primarily develop and deploy scripts as shell scripts and the Console scheme should never be a consideration in that mode.</p>
<p>I understand that the whole Port model could use a fair degree of scrutiny—and I certainly can't speak to the rectitude of using FILE as the default I/O scheme (I don't have that systemic understanding), but it seems that the long arc of Rebol 3/Ren-C development has kind-of skirted this core concern.</p>
          <p><a href="https://forum.rebol.info/t/input-output-error-ports/1248/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.rebol.info/t/input-output-error-ports/1248/1</link>
        <pubDate>Fri, 06 Dec 2019 18:28:03 +0000</pubDate>
        <guid isPermaLink="false">forum.rebol.info-post-1248-1</guid>
        <source url="https://forum.rebol.info/t/input-output-error-ports/1248.rss">Input/Output/Error Ports</source>
      </item>
  </channel>
</rss>
