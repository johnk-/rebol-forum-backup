<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Simple Objects vs. What The People Want - #8 by hostilefork - Optimization - AltRebol</title>
    <meta name="description" content="Ren-C has a more streamlined version of how R3-Alpha implemented simple OBJECT!s, but it&amp;#39;s really mostly the same (though MODULE! has changed significantly) 
An OBJECT! is just two parallel lists, which I have called the&amp;hellip;">
    <meta name="generator" content="Discourse 2.7.0.beta4 - https://github.com/discourse/discourse version 3fc72543de22c329cf2156f28b781821adc496ae">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/1X/cbd70027b53fa165575e5b665f00eb3b8ae7ea31_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../1745.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.rebol.info","potentialAction":{"@type":"SearchAction","target":"https://forum.rebol.info/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="AltRebol Search">

      <link href="https://forum.rebol.info/stylesheets/desktop_e71c7b3a0694e7f6434c54a663bfb42821f8bd81.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="desktop" />
    
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Simple Objects vs. What The People Want&#39;" href="../1745.rss" />
    <meta property="og:site_name" content="AltRebol" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:url" content="https://forum.rebol.info/t/simple-objects-vs-what-the-people-want/1745/8" />
<meta name="twitter:url" content="https://forum.rebol.info/t/simple-objects-vs-what-the-people-want/1745/8" />
<meta property="og:title" content="Simple Objects vs. What The People Want" />
<meta name="twitter:title" content="Simple Objects vs. What The People Want" />
<meta property="og:description" content="So I&#39;ll just restate that improving the runtime thing that is &quot;OBJECTMAP!&quot; is clearly on the agenda, but these source representation issues are related and important to get at too.   Clearly I am sympathetic that it would be nice if we could have a &quot;this is an object&quot; notation at source level.  To say &quot;all you need is MAKE OBJECT! on BLOCK!&quot; is like saying you don&#39;t need GROUP! (since you can DO a BLOCK!)  However, in &quot;Rebol&#39;s JSON&quot; I just suggested assuming all BLOCK! that start with SET-WORD! ..." />
<meta name="twitter:description" content="So I&#39;ll just restate that improving the runtime thing that is &quot;OBJECTMAP!&quot; is clearly on the agenda, but these source representation issues are related and important to get at too.   Clearly I am sympathetic that it would be nice if we could have a &quot;this is an object&quot; notation at source level.  To say &quot;all you need is MAKE OBJECT! on BLOCK!&quot; is like saying you don&#39;t need GROUP! (since you can DO a BLOCK!)  However, in &quot;Rebol&#39;s JSON&quot; I just suggested assuming all BLOCK! that start with SET-WORD! ..." />
<meta property="article:published_time" content="2021-10-23T07:34:19+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="https://forum.rebol.info/">
          <img src="../../../uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" alt="AltRebol" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="../1745.html">Simple Objects vs. What The People Want</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/development/8" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/development/optimization/53" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Optimization</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../1745.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-10-18T06:45:29Z' class='post-time'>
                October 18, 2021,  6:45am
              </time>
              <meta itemprop='dateModified' content='2021-10-18T06:45:29Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Ren-C has a more streamlined version of how R3-Alpha implemented simple OBJECT!s, but it's really mostly the same <em>(though MODULE! has changed significantly)</em></p>
<p>An OBJECT! is just two parallel lists, which I have called the <strong>"keylist"</strong> and the <strong>"varlist"</strong>.</p>
<p>So if you say something like:</p>
<pre><code>obj: make object! [
    x: 1 + 2
    y: 10 + 20
]
</code></pre>
<p>You will get:</p>
<pre><code>keylist: {symbol(x) symbol(y)}
varlist: [*V0* 3 30]
</code></pre>
<p>The first slot in a varlist is used for some tracking information.  So:</p>
<ul>
<li>
<code>keylist[0]</code> is the key for <code>varlist[1]</code>
</li>
<li>
<code>keylist[1]</code> is the key for <code>varlist[2]</code>
</li>
</ul>
<h2>You Get A New Keylist With Every MAKE OBJECT!</h2>
<p>Nothing in the system goes around looking for common patterns in your object creation to notice that you've made several objects with the same keys.</p>
<pre><code>collect [
    count-up i 1000 [
        keep make object! [x: i * 10, y: i * 20]
    ]
]
</code></pre>
<p>You just made 1000 objects, and all of them have their own copy of the keylist <code>{symbol(X) symbol(Y)}</code>.  Ren-C made this overhead cost less than 1/4 as much as R3-Alpha, but it's still kind of lame.</p>
<p><strong>The only way you avoid making a new keylist is if you do object inheritance.</strong></p>
<pre><code>point!: make object! [x: y: null]
collect [
    count-up i 1000 [
        keep make point! [x: i * 10, y: i * 20]
    ]
]
</code></pre>
<p>This time, there's 1000 objects all sharing a single keylist.</p>
<p><strong>If you expand keys at all, that will result in a new keylist...</strong></p>
<p>You spoil the optimization if you put anything additional in your derived object:</p>
<pre><code>point!: make object! [x: y: null]
collect [
    count-up i 1000 [
        keep make point! [x: i * 10, y: i * 20, z: i * 30]
    ]
]
</code></pre>
<p>There's no inheritance mechanism that makes use of the common sublist.  So this puts you at <em>1001</em> keylists, because your keylist for the original point! never gets used.</p>
<p><strong>Object Expansion via APPEND disconnects shared keylists</strong></p>
<p>R3-Alpha allowed you to add fields to an object.  If you did so, you would lose any sharing that it had taken advantage of before.</p>
<pre><code>p: make point! [x: 10 y: 20]  ; reuses point!'s keylist
append p [z: 30]  ; oop, not anymore...gets its own keylist.
</code></pre>
<p><strong>Comparisons Are Difficult</strong></p>
<p>Because there's no global mechanism of canonization of keylists, you get entirely different-looking objects by creating the fields in different orders.</p>
<pre><code>obj1: make object! [x: 10 y: 20]
obj2: make object! [y: 20 x: 10]
</code></pre>
<p>These objects have been considered to be not equal historically.  Because comparisons are done by walking the fields in order.  So obj1 &lt;&gt; obj2 in this case.</p>
<p>However, if you create an object via inheritance so it shares a keylist, that will standardize the order of the fields:</p>
<pre><code>point1: make point! [x: 10 y: 20]
point2: make point! [y: 20 x: 10]
</code></pre>
<p>Here we will have point1 = point2, since their shared keylist forces the order of x and y to whatever it was in POINT!.</p>
<h2>There Are Fancier Ways Of Dealing With This</h2>
<p><strong>If you're willing to say that the order of keys in objects shouldn't matter...</strong> then you can rethink the data structures to exploit commonalities in the patterns of keys that are created.</p>
<p>The V8 JavaScript engine approaches this with <strong><a href="https://richardartoul.github.io/jekyll/update/2015/04/26/hidden-classes.html">Hidden Classes</a></strong>.</p>
<p>But there's really always some other way of approaching the problem.  The way modules work in "Sea of Words" is an example of a structure that seems to work reasonably well for modules--but wouldn't work as well for lots of little objects.</p>
<h2>Today's FRAME! Depends On This Non-Fancy Way</h2>
<p>Right now, when a native runs it does so with a concept of the order of the arguments and refinements that gets baked into the C code directly.  IF knows that the condition is argument 1 and that the branch is argument 2, and it looks directly in slots 1 and 2 of the varlist of the frame to find those variables.</p>
<p>This is pretty foundational to the idea of the language, and is part of what gives it an appealing "simple-ness".</p>
<p>Ren-C has come along and permitted higher level mechanisms like specialization and adaptation, but everything is always getting resolved in a way that each step in a function's composition works on putting information into the exact numbered slot that the lower levels expect it to be in.</p>
<h2>Binding Has Depended On This Non-Fancy Way</h2>
<p>A premise in Rebol has been that you can make a connection between a variable and an object that has a key with the name of that variable, and once that connection is made it will last.  This rule is why there's been dodginess about deleting keys in objects or rearranging them...and why R3-Alpha permits adding new variables but not removing any.</p>
<pre><code> obj: make object! [x: 10 y: 20]
 code: [x + y]
 bind code obj
</code></pre>
<p>If you write something like the above, you are annotating the X inside of CODE with (obj field <span class="hashtag">#1</span>), and the Y inside of CODE with (obj field <span class="hashtag">#2</span>).  So nothing can happen with obj that can break that.</p>
<p><strong>This isn't strictly necessary.</strong>  It could have annotated X and Y with just (obj) and then gone searching each time it wanted to find it.  This would permit arbitrary rearrangement of OBJ, inserting and removing keys.  It could even remove X or Y and then tell you it couldn't find them anymore.</p>
<p>There are compromises as well.  The binding could be treated as a potentially fallible cache...it could look in that slot position (if it's less than the total keylist size) and see if the key matched.  If not, it could fall back on searching and then update with the slot where it saw the field.</p>
<p>(Of course this means you have to look at the keylist instead of just jumping to where you want to be in the varlist, and locality is such that they may not be close together; so having to look at the keylist <em>at all</em> will bring you a slowdown.)</p>
<h2>But What Is The Goal, Here?</h2>
<p>I've mentioned how the FRAME! design pretty much seems to go along well with the naive ordering of object fields.</p>
<p>I guess this is where your intuition comes in as to what represents "sticking to the rules of the game".  <em>And I think that hardcoding of positions into the executable of where to find the argument cells for natives is one of the rules.</em></p>
<p>This suggests that all functions hardcode the positions of their arguments--even usermode functions.  I'm okay with this.</p>
<p>So then we get to considering the question about OBJECT!.</p>
<ul>
<li>
<p>A lot of languages force you to predefine the structure of an object before creating instances.  And defining that structure is a good place to define its interfaces.  If Rebol wants to go in a more formal direction (resembling a Rust/Haskell/C++) then you might suggest you <em>always</em> make a base structure...and you can only have the fields named in it.</p>
</li>
<li>
<p>Other languages (like JavaScript) are more freeform, and as mentioned can look for the relationships after-the-fact.  Order of fields does not matter.</p>
</li>
</ul>
<p>It's clear that Rebol's userbase so far are people who would favor better implementation of the JavaScript model over going to more strictness.  I think there'd be a pretty good reception of a model where you could create objects with <strong>{...}</strong> and where fields could be added or removed as people saw fit.  If behind-the-scenes the system was optimizing access to those objects, that would presumably be preferable to this idea that you had to be responsible for declaring prototypes to get efficiencies (that would instantly disappear if you added another field).</p>
<p>But the mechanics definitely get more complicated.  :-/</p>
        </div>

        <meta itemprop='headline' content='Simple Objects vs. What The People Want'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/rgchris'><span itemprop='name'>rgchris</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../1745.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2021-10-18T20:46:22Z'>
              <time itemprop='dateModified' datetime='2021-10-18T21:24:01Z' class='post-time'>
                October 18, 2021,  9:24pm
              </time>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>This seems to omit one feature of Javascript objects that can be efficient (as much as I'm aware of how such things are implemented)—something I sort of alluded to in my <a href="../../class-an-alternative-to-method/1440.html">class proposal</a>.</p>
<p>That is that JavaScript objects (essentially maps in the Rebolsphere) only contain a keylist for values that are different and keys common to a type of object are contained in the prototype's keylist (or the prototype's prototype all the way back to the Object object).</p>
<p>The implementation is a bit awkward requiring constructors and such, but I'll try and relate to the above (could use <code>Object.create</code> but with caveats):</p>
<pre><code class="lang-javascript">// first point of awkwardness, we generally need a function
// to create a prototype
//
let Point = function () {}

// now that we have this base, we can build the prototype
//
Object.assign(
    Point.prototype, {
        x: 0, y: 0,
        form: function () {return this.x + 'x' + this.y}
        // `this` in methods is not equiv. to Rebol's `self`
    }  // &lt;= the prototype we really want
)

//
// Point.prototype has a keylist of [x, y, form]
//

// Create a new derivative object with a keylist of []
//
let point_1 = new Point()

console.log( point_1.x )  // =&gt; 0

// Let's expand the keylist to [x]
//
point_1.x = 1

// It still resolves `y` from the prototype
//
console.log( point_1.y )  // =&gt; 0

// And the method will work back through the
// prototype chain to resolve each key
//
console.log( point_1.form() )  // =&gt; '1x0'

// Creating another derivative object with a novel key
// does not alter the prototype or other inherited types
// 
let point_2 = new Point()
point_2.z = 10

console.log( Point.prototype.z )  // =&gt; undefined
console.log( point_1.z )  // =&gt; undefined

// Keys added to the prototype are available to derivatives
//
Point.prototype.z = 100

console.log( point_1.z )  // =&gt; 100
</code></pre>
<p>Anyways, there's a few more interesting features related to this, but thought it worth adding the essential model to the mix.</p>
        </div>

        <meta itemprop='headline' content='Simple Objects vs. What The People Want'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../1745.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2021-10-21T01:50:41Z'>
              <time itemprop='dateModified' datetime='2021-10-21T01:51:02Z' class='post-time'>
                October 21, 2021,  1:51am
              </time>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="rgchris" data-post="2" data-topic="1745">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/rgchris/40/14_2.png" class="avatar"> rgchris:</div>
<blockquote>
<p>The implementation is a bit awkward requiring constructors and such,</p>
</blockquote>
</aside>
<p>This is good to point out...and I think in general that if you look at a lot of the realities of making objects, you wind up creating functions to do it.</p>
<p>It's another point that making braces that just fabricate objects when they are visited might not be all they're cracked up to be.  (Though I've put the idea through consideration, especially as it was proposed for Carl's new ASON, <a href="../../rethinking-braces-as-an-array-type/1727/26.html">I'm becoming increasingly skeptical</a>.)</p>
        </div>

        <meta itemprop='headline' content='Simple Objects vs. What The People Want'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/IngoHohmann'><span itemprop='name'>IngoHohmann</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../1745.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-10-21T05:45:09Z' class='post-time'>
                October 21, 2021,  5:45am
              </time>
              <meta itemprop='dateModified' content='2021-10-21T05:45:09Z'>
          <span itemprop='position'>#4</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>One more thing against the idea: I could imagine, that something that looks a bit like json, and works a bit like json, and then falls short of being compatible, will lead to a lot of confusion.</p>
        </div>

        <meta itemprop='headline' content='Simple Objects vs. What The People Want'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/rgchris'><span itemprop='name'>rgchris</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../1745.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-10-21T22:41:29Z' class='post-time'>
                October 21, 2021, 10:41pm
              </time>
              <meta itemprop='dateModified' content='2021-10-21T22:41:29Z'>
          <span itemprop='position'>#5</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I'd again look at the intersection of MAP! and OBJECT! and <a href="../../maps-versatile-interface/1465.html">where each apply</a>.</p>
<p>I'd contend that if Rebol 2 had a MAP! datatype from the outset, objects wouldn't be as prevalent as they are and we'd have been better off from having that distinction in code, e.g.:</p>
<pre><code class="lang-nohighlight">read/custom http://some.site/ #(
    Accept: "text/x-rebol"
)
</code></pre>
<p><em>(continued objections with the <code>#()</code> notation aside, etc.)</em></p>
<p>Having MAP! values (especially where they have literal notation) takes pressure off that usage of OBJECT! Indeed having MAP! and MODULE! around should already have sharpened the focus for the role OBJECT! fills: not as an awkward stand-in for a key-value type, nor a discrete context for library/support code.</p>
<p>I could refer to the <a href="http://rebol.info/rebolsteps.html#section-8">Ten Steps definition</a> where it kind of pertains to classical Object Oriented programming—where that might be desirable (could argue it has its place); or perhaps Javascript where (with but a few exceptions) every value is an object (even Array is but an object with numeric string keys for entries). While I wouldn't necessarily suggest going to the latter extreme, it's not without its own merits (again, is an inspiration for my class proposal).</p>
<p>I don't think any particular idea should be off the table and I don't think it need interfere with any codebases (such that they exist) in that they should for the most part be migrating to MAP! and MODULE! for most all of the common usages</p>
<hr>
<p>I'd add that it's reasonably clear that JSON 'objects' are analogous to MAP! values and that JSON should map fully to BLANK!, LOGIC!, INTEGER!, DECIMAL!, TEXT!, BLOCK!, MAP! and that OBJECT! be as far away from that discussion as is possible (as it should be from Re[*] source notation).</p>
<hr>
<p>Back to Javascript, where in addition to stating above that objects are just associative arrays with an inheritance chain and without context, a Map is an Object that acts as a mediator to an additional structure storing keys and values—not effectively different than, say, using an OBJECT! in Rebol 2 to create a map-like interface (except that that structure <em>may</em> be optimized in native code). Could argue that they've tied their own hands by using <code>{...}</code> as Object notation instead of Map</p>
        </div>

        <meta itemprop='headline' content='Simple Objects vs. What The People Want'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../1745.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2021-10-23T05:26:06Z'>
              <time itemprop='dateModified' datetime='2021-10-23T05:27:35Z' class='post-time'>
                October 23, 2021,  5:27am
              </time>
          <span itemprop='position'>#6</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="rgchris" data-post="5" data-topic="1745">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/rgchris/40/14_2.png" class="avatar"> rgchris:</div>
<blockquote>
<p>I'd contend that if Rebol 2 had a MAP! datatype from the outset, objects wouldn't be as prevalent as they are and we'd have been better off from having that distinction in code, e.g.:</p>
<pre><code>read/custom http://some.site/ #(
    Accept: "text/x-rebol"
)
</code></pre>
<p><em>(continued objections with the <code>#()</code> notation aside, etc.)</em></p>
</blockquote>
</aside>
<p>I've written up my concerns about source-level MAP!s...a big one being "when (if ever) do you evaluate":</p>
<p><a href="../../rethinking-braces-as-an-array-type/1727/25.html" class="inline-onebox">{ Rethinking Braces }... as an array type? - #25 by hostilefork</a></p>
<p>LOAD-time is before binding so that won't work.  And then if you do it at any other time, you wind up with something that's just a shorthand for MAKE OBJECT!...and will still need evaluation.</p>
<p>I don't see anyone being satisfied with the behavior of:</p>
<pre><code>read/custom http://some.site/ #(
    Accept: "text/x-rebol"
    Upgrade-Insecure-Requests: secure-base + 1
)
</code></pre>
<p>This is no good if it's redefining <strong>+</strong> to be <strong>1</strong>.  So if we know that's bad, what's left that's good?</p>
<p>If the issue is wanting to have a way of saying <em>"I'm giving you a lower, rawer form of input that's not dialected"</em> then maybe that's a good fit for the @[...] array type.  "This is just keys and values, I promise".</p>
<pre><code>read/custom http://some.site/ @[
    Accept: "text/x-rebol"
    Upgrade-Insecure-Requests: 2
]
</code></pre>
<p><a href="../../a-lot-to-unpack-replacing-the-set-of-reduce-block-idiom/1634.html">This tactic is taken with UNPACK, for example.</a>...which I think is clever.</p>
<p>But maybe the default of when you get a BLOCK! is "this is information in the READ/CUSTOM dialect", whatever that means.  And its job is to produce the keys and values somehow.  But you can bypass that intelligence with something that requests unintelligence.</p>
<blockquote>
<p>I don't think any particular idea should be off the table</p>
</blockquote>
<p>Definitely good to clock some time with other languages (which I've been doing recently) and to ask if there are lessons there to be learned.</p>
<p>I went down the road of thinking about {...} for a use besides strings.  But I think that what we might see from <strong><a href="../../could-strings-have-context/587/10.html">strings being more powerful with binding for interpolation</a></strong> could usher in a new area.</p>
        </div>

        <meta itemprop='headline' content='Simple Objects vs. What The People Want'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/rgchris'><span itemprop='name'>rgchris</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../1745.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-10-23T05:58:52Z' class='post-time'>
                October 23, 2021,  5:58am
              </time>
              <meta itemprop='dateModified' content='2021-10-23T05:58:52Z'>
          <span itemprop='position'>#7</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="hostilefork" data-post="6" data-topic="1745">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/hostilefork/40/26_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<p>I've written up my concerns about source-level MAP!s...a big one being "when (if ever) do you evaluate":</p>
</blockquote>
</aside>
<p>I did see that, and while I get that there are issues with evaluation in such a construct, for the purposes of staying on-topic I'll not dig into that so much as to say more than: a convenient key-value type with source prominence can remove that traditional burden from the object type. I think this is worth stating again given the traditional perception and usage of objects in Rebol.</p>
        </div>

        <meta itemprop='headline' content='Simple Objects vs. What The People Want'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../1745.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2021-10-23T07:34:19Z'>
              <time itemprop='dateModified' datetime='2021-10-23T08:41:22Z' class='post-time'>
                October 23, 2021,  8:41am
              </time>
          <span itemprop='position'>#8</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>So I'll just restate that improving the runtime thing that is "OBJECTMAP!" is clearly on the agenda, but these source representation issues are related and important to get at too.</p>
<aside class="quote no-group" data-username="rgchris" data-post="7" data-topic="1745">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/rgchris/40/14_2.png" class="avatar"> rgchris:</div>
<blockquote>
<p>a convenient key-value type with source prominence can remove that traditional burden from the object type. I think this is worth stating again given the traditional perception and usage of objects in Rebol.</p>
</blockquote>
</aside>
<p>Clearly I am sympathetic that it would be nice if we could have a "this is an object" notation at source level.</p>
<p>To say "all you need is MAKE OBJECT! on BLOCK!" is like saying you don't need GROUP! (since you can DO a BLOCK!)</p>
<p>However, in "Rebol's JSON" I just suggested <a href="../../rethinking-braces-as-an-array-type/1727/30.html">assuming all BLOCK! that start with SET-WORD! are objects</a>, and then have some escape notation for the outliers.</p>
<p>There's a sense where recognizing BLOCK!-starting-with-SET-WORD! is an unsatisfying answer.  But also a way in which you can choose to find it satisfying.  It does have its upsides: Rebol is good at working with and composing blocks, they're inert and use the most pleasing bracket...</p>
<aside class="quote no-group" data-username="rgchris" data-post="7" data-topic="1745">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/rgchris/40/14_2.png" class="avatar"> rgchris:</div>
<blockquote>
<p>I get that there are issues with evaluation in such a construct</p>
</blockquote>
</aside>
<p>Maybe the operator that loads the above-proposed "Rebol JSON" is something easy to use.  I propose it maybe being a symbol and done via its own array type.  But maybe it's so foundational it should take the name MAKE (we never figured out what the difference of MAKE and TO are, really...)</p>
<p>I dunno, but let's look at having it take over <strong>MAKE</strong> as a placeholder for "really easy to ask for" <em>(and potentially giving us MAKE-WORD!, MAKE-BLOCK!, etc. as easy named variants)</em></p>
<pre><code>&gt;&gt; stuff: make [
     name: "objects"
     list: [[a: 10 b: 10 + 10] &lt;gap&gt; [a: 30 b: 20 + 20]]
]
== #objectmap![
    name: "objects"
    list: [
        #objectmap![a: 10 b: 20]
        &lt;gap&gt;
        #objectmap![a: 30 b: 40]
   ]
]
</code></pre>
<p>I do think that it's worth pointing out generic quoting as a way to escape out of evaluation when you don't want it:</p>
<pre><code>&gt;&gt; stuff: make [
     name: "plain block"
     list: '[[a: 10 b: 10 + 10] &lt;gap&gt; [a: 30 b: 20 + 20]]
]
== #objectmap![
   name: "plain block"
   list: [[a: 10 b: 10 + 10] &lt;gap&gt; [a: 30 b: 20 + 20]]
]

&gt;&gt; stuff: make [
     name: "list with objects and blocks"
     list: [[a: 10 b: 10 + 10] &lt;gap&gt; '[a: 30 b: 20 + 20]]
]
== #objectmap![
    name: "list with objects and blocks"
    list: [
        #objectmap![a: 10 b: 20]
        &lt;gap&gt;
        [a: 30 b: 20 + 20]
   ]
]
</code></pre>
<p>And you still have full representational coverage...double quoting to give you a single-quoted block if that's what you meant:</p>
<pre><code>&gt;&gt; stuff: make [
     name: "quoted block"
     list: ''[[a: 10 b: 10 + 10] &lt;gap&gt; [a: 30 b: 20 + 20]]
]
== #objectmap![
   name: "quoted block"
   list: '[[a: 10 b: 10 + 10] &lt;gap&gt; [a: 30 b: 20 + 20]]
]
</code></pre>
<p>That little twist of "quoted things are always that thing minus one quote level, but unquoted things can be more free in their meaning" is something that has shown to have a lot of interesting applications.  And here we see it letting us say non-quoted blocks are subject to the "might represent an object" treatment.</p>
<p><img src="../../../images/emoji/twitter/man_shrugging.png%3Fv=9" title=":man_shrugging:" class="emoji" alt=":man_shrugging:">  I think it's cool.</p>
        </div>

        <meta itemprop='headline' content='Simple Objects vs. What The People Want'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/categories' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/guidelines' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  
</html>
