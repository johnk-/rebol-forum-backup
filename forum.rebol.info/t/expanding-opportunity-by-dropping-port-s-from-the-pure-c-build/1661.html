<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Expanding Opportunity (by Dropping PORT!s from the pure C Build) - Ports - AltRebol</title>
    <meta name="description" content="I was closing and resolving all the rebol-issues tickets related to PARSE...considering them &amp;quot;resolved&amp;quot; if they are solved by UPARSE.  Quite a lot of them were!  :partying_face: 
Among the few tickets that weren&amp;#39;t resolv&amp;hellip;">
    <meta name="generator" content="Discourse 2.7.0.beta4 - https://github.com/discourse/discourse version 3fc72543de22c329cf2156f28b781821adc496ae">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/cbd70027b53fa165575e5b665f00eb3b8ae7ea31_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="1661.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.rebol.info","potentialAction":{"@type":"SearchAction","target":"https://forum.rebol.info/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="AltRebol Search">

      <link href="https://forum.rebol.info/stylesheets/desktop_e71c7b3a0694e7f6434c54a663bfb42821f8bd81.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="desktop" />
    
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Expanding Opportunity (by Dropping PORT!s from the pure C Build)&#39;" href="1661.rss" />
    <meta property="og:site_name" content="AltRebol" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:url" content="https://forum.rebol.info/t/expanding-opportunity-by-dropping-port-s-from-the-pure-c-build/1661" />
<meta name="twitter:url" content="https://forum.rebol.info/t/expanding-opportunity-by-dropping-port-s-from-the-pure-c-build/1661" />
<meta property="og:title" content="Expanding Opportunity (by Dropping PORT!s from the pure C Build)" />
<meta name="twitter:title" content="Expanding Opportunity (by Dropping PORT!s from the pure C Build)" />
<meta property="og:description" content="I was closing and resolving all the rebol-issues tickets related to PARSE...considering them &quot;resolved&quot; if they are solved by UPARSE.  Quite a lot of them were!  ðŸ¥³  Among the few tickets that weren&#39;t resolved was an old one in which BrianH talks about adding an /IGNORE flag to PARSE:  Rebol Issue #1080  But to me... this sounds like a generalized feature being narrowly articulated as a PARSE wish.  What he&#39;s asking for is there to be a kind of iterator over a series which does not ..." />
<meta name="twitter:description" content="I was closing and resolving all the rebol-issues tickets related to PARSE...considering them &quot;resolved&quot; if they are solved by UPARSE.  Quite a lot of them were!  ðŸ¥³  Among the few tickets that weren&#39;t resolved was an old one in which BrianH talks about adding an /IGNORE flag to PARSE:  Rebol Issue #1080  But to me... this sounds like a generalized feature being narrowly articulated as a PARSE wish.  What he&#39;s asking for is there to be a kind of iterator over a series which does not ..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="2 mins ðŸ•‘" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="3 â¤" />
<meta property="article:published_time" content="2021-08-14T08:34:45+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="https://forum.rebol.info/">
          <img src="../../uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" alt="AltRebol" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="1661.html">Expanding Opportunity (by Dropping PORT!s from the pure C Build)</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/development/8" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/development/ports/37" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Ports</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="1661.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2021-08-14T08:34:45Z'>
              <time itemprop='dateModified' datetime='2021-08-14T17:56:24Z' class='post-time'>
                August 14, 2021,  5:56pm
              </time>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I was closing and resolving all the rebol-issues tickets related to PARSE...considering them "resolved" if they are solved by UPARSE.  <em>Quite a lot of them were!</em>  <img src="../../images/emoji/twitter/partying_face.png%3Fv=9" title=":partying_face:" class="emoji" alt=":partying_face:"></p>
<p>Among the few tickets that weren't resolved was an old one in which BrianH talks about adding an /IGNORE flag to PARSE:</p>
<p><strong><a href="https://github.com/metaeducation/rebol-issues/issues/1080">Rebol Issue #1080</a></strong></p>
<p>But to me... <strong>this sounds like a generalized feature being narrowly articulated as a PARSE wish.</strong></p>
<p>What he's asking for is there to be a kind of iterator over a series which does not show some of its content.  The closest concept that Rebol has potentially had for this would be a PORT!.</p>
<p>Here's some random imaginary pseudocode:</p>
<pre><code>&gt;&gt; input: [1 2 3 4 5 6 7 8]

&gt;&gt; port: make-filtering-port input :even?
== #[port! [...]]

&gt;&gt; read/part port 2
== [2 4]

&gt;&gt; read/part port 2
== [6 8]
</code></pre>
<p>Ideally you could do this kind of filtering on a file on disk, a series in memory, a network stream, etc.  Even if the file were gigabytes in size you wouldn't wind up creating a huge amount of data just to iterate over the even numbers in it.</p>
<h2>This Kind of Mechanic Has Prior Art</h2>
<p><em>(Well, at least when I assume you're not asking for the impossible.  e.g. the data you're filtering is read only.  And you're not expecting to be able to have some automatic way of inserting things in the middle of a disk file and sliding the contents up...writing back over only the even values.  Sane requests here only, please.)</em></p>
<p>In the past I've often brought up <a href="http://think-async.com/Asio/">Boost.ASIO, the C++ Asynchronous I/O library</a>.  It's for wiring up streams and layering them...dealing with buffering and disconnection exceptions and multi-platform eventing.  The whole nine yards.</p>
<p>The filtering example I give above is actually one of the textbook examples of something you can do in Boost by building on streaming iterators:</p>
<pre><code>struct is_even {
    bool operator()( int x ) const { return x % 2 == 0; }
};

std::vector&lt;int&gt; input;
input += 1,2,3,4,5,6,7,8,9;

boost::copy(
    input | filtered(is_even()),
    std::ostream_iterator&lt;int&gt;(std::cout, ","));
</code></pre>
<p>That gives the output <strong>2,4,6,8,</strong></p>
<p>But it goes much further than that.  You really can stack a streaming decompressor on top of a network port, and then stick a TCP processor and a TLS layer and an HTTP layer on top of that: <a href="https://dens.website/tutorials/cpp-asio/ssl-tls">https://dens.website/tutorials/cpp-asio/ssl-tls</a></p>
<p>There's a library for WebSockets in Boost.ASIO, and I've already talked about how I think it's important for the desktop executable to be able to speak to the browser automation APIs.</p>
<h2>Plan: Strip PORT! Out of The Pure C Build</h2>
<p>There's no reason that the pure C build can't read files into memory in one fell swoop, and be able to bootstrap itself.  But I can say without a doubt that with the PORT! implementation behind the scenes today: <em>"There's no gold in them thar hills."</em></p>
<p>So why not leave the pure C build with the basics of reading and writing files in their entirety... very simple and without any need for a PORT! model.  Then start from scratch on ports embracing existing work as much as possible, and building on proven and tested code?</p>
<p>We'll keep the CALL facility written in pure C for now.  That way the basic executables can always reach out to curl or wget or whatever, if they want to trigger something like a network request.</p>
<h2>Starting From Scratch Can Advance Rapidly</h2>
<p>It should be clear from UPARSE that when I start out tackling a problem anew with the stored up knowledge and experience from seeing the previous problems, the results can be good.</p>
<p>I've not really worked much on the port model, because there was no model there.  But in keeping the code adjusted to stay running and be more convenient over time, a ton of design points on the core have been stressed.  So as bad as much of the code is, it's been a proving ground for various pieces of the system.</p>
<p>But now...it's time.  I think that basically wiping out pretty much all the PORT! code and starting again can go nowhere but up!</p>
        </div>

        <meta itemprop='headline' content='Expanding Opportunity (by Dropping PORT!s from the pure C Build)'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="1661.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2021-08-18T06:44:19Z'>
              <time itemprop='dateModified' datetime='2021-08-27T00:15:53Z' class='post-time'>
                August 27, 2021, 12:15am
              </time>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="hostilefork" data-post="1" data-topic="1661">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/hostilefork/40/26_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<p>In the past I've often brought up <a href="http://think-async.com/Asio/">Boost.ASIO, the C++ Asynchronous I/O library</a>. It's for wiring up streams and layering them...dealing with buffering and disconnection exceptions and multi-platform eventing.</p>
</blockquote>
</aside>
<p>Looking at the C++ ASIO in more detail for non-network applications (e.g. streaming files) it doesn't offer as much as I thought in that area.  The streaming is all byte-level so you have to build higher level services based on eventing if you want to come up with streams of objects.  So it really doesn't map well to Haskell libraries like Conduit or Pipes the way I might have imagined.  <img src="../../images/emoji/twitter/frowning.png%3Fv=9" title=":frowning:" class="emoji" alt=":frowning:"></p>
<p>It may be that the path of least resistance library--which provides more of a generic platform abstraction layer--is likely libuv:</p>
<p><a href="http://docs.libuv.org/en/v1.x/design.html" class="inline-onebox">Design overview â€” libuv documentation</a></p>
<p><a href="https://nikhilm.github.io/uvbook/An%20Introduction%20to%20libuv.pdf">https://nikhilm.github.io/uvbook/An%20Introduction%20to%20libuv.pdf</a></p>
<p>It's used by Node.js and Julia and Rust, and in a number of standalone servers and clients.  It seems to be pure C, and may even compile with tcc.  We'll see.</p>
<h1>Either way, my point remains the same...</h1>
<p>It's time to kill off the R3-Alpha networking and file system code.  There's nothing there to fix.</p>
<ul>
<li>
<p><strong>We won't wind libUV in with the core--provably so--because the WebAssembly build won't use it.</strong></p>
</li>
<li>
<p><strong>It will also be provable because we'll allow making desktop builds without it...they just won't have PORT!s.</strong>  They will have READ-FILE, WRITE-FILE, and CALL.</p>
</li>
</ul>
<p>I'm trying to get the Sea of Words and Roaring Bitsets stuff tied up, but I'm actually looking forward to deleting the R3-Alpha "Device" layer.  The time I've spent with it has really been about switching it to do more of its work in terms of Rebol values and APIs...so hopefully that will pay off in terms of having hardened things to be able to interface nicely with libuv.</p>
        </div>

        <meta itemprop='headline' content='Expanding Opportunity (by Dropping PORT!s from the pure C Build)'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/categories' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/guidelines' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  
</html>
