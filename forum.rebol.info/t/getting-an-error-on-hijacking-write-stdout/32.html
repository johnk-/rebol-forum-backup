<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Getting an error on hijacking write-stdout - First Steps - AltRebol</title>
    <meta name="description" content="old-write-stdout: copy :write-stdout

so-print: procedure [
    &amp;quot;Switch between using a print or a so-print operation for the bot&amp;quot;
    val [logic!]
][
    write %so-print.txt copy &amp;quot;&amp;quot;
    either val [
        print &amp;quot;so-pr&amp;hellip;">
    <meta name="generator" content="Discourse 2.7.0.beta4 - https://github.com/discourse/discourse version 3fc72543de22c329cf2156f28b781821adc496ae">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/cbd70027b53fa165575e5b665f00eb3b8ae7ea31_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="32.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.rebol.info","potentialAction":{"@type":"SearchAction","target":"https://forum.rebol.info/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="AltRebol Search">

      <link href="https://forum.rebol.info/stylesheets/desktop_e71c7b3a0694e7f6434c54a663bfb42821f8bd81.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="desktop" />
    
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Getting an error on hijacking write-stdout&#39;" href="32.rss" />
    <meta property="og:site_name" content="AltRebol" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:url" content="https://forum.rebol.info/t/getting-an-error-on-hijacking-write-stdout/32" />
<meta name="twitter:url" content="https://forum.rebol.info/t/getting-an-error-on-hijacking-write-stdout/32" />
<meta property="og:title" content="Getting an error on hijacking write-stdout" />
<meta name="twitter:title" content="Getting an error on hijacking write-stdout" />
<meta property="og:description" content="old-write-stdout: copy :write-stdout  so-print: procedure [     &quot;Switch between using a print or a so-print operation for the bot&quot;     val [logic!] ][     write %so-print.txt copy &quot;&quot;     either val [         print &quot;so-print is now on&quot;         hijack &#39;write-stdout func [value][             write/append %so-print.txt value         ]     ][         hijack &#39;write-stdout :old-write-stdout     ] ]  so-print on print &quot;hello&quot; so-print off  gives me this error  managed series was likely created during ev..." />
<meta name="twitter:description" content="old-write-stdout: copy :write-stdout  so-print: procedure [     &quot;Switch between using a print or a so-print operation for the bot&quot;     val [logic!] ][     write %so-print.txt copy &quot;&quot;     either val [         print &quot;so-print is now on&quot;         hijack &#39;write-stdout func [value][             write/append %so-print.txt value         ]     ][         hijack &#39;write-stdout :old-write-stdout     ] ]  so-print on print &quot;hello&quot; so-print off  gives me this error  managed series was likely created during ev..." />
<meta property="article:published_time" content="2017-05-18T20:44:52+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="https://forum.rebol.info/">
          <img src="../../uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" alt="AltRebol" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="32.html">Getting an error on hijacking write-stdout</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/usage/7" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #3AB54A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Usage</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/usage/first-steps/10" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #3AB54A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>First Steps</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../tag/hijack.html' class='discourse-tag' rel="tag">hijack</a>
        </div>
      </div>
  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/gchiu'><span itemprop='name'>gchiu</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="32.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2017-05-18T20:44:52Z'>
              <time itemprop='dateModified' datetime='2017-05-18T20:45:36Z' class='post-time'>
                May 18, 2017,  8:45pm
              </time>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <pre><code>old-write-stdout: copy :write-stdout

so-print: procedure [
    "Switch between using a print or a so-print operation for the bot"
    val [logic!]
][
    write %so-print.txt copy ""
    either val [
        print "so-print is now on"
        hijack 'write-stdout func [value][
            write/append %so-print.txt value
        ]
    ][
        hijack 'write-stdout :old-write-stdout
    ]
]

so-print on
print "hello"
so-print off
</code></pre>
<p>gives me this error</p>
<pre><code>managed series was likely created during evaluator tick: 539490
</code></pre>
<p>What does this mean?  And how do I fix it?</p>
        </div>

        <meta itemprop='headline' content='Getting an error on hijacking write-stdout'>
          <meta itemprop='keywords' content='hijack'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/gchiu'><span itemprop='name'>gchiu</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="32.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2017-05-18T21:43:30Z' class='post-time'>
                May 18, 2017,  9:43pm
              </time>
              <meta itemprop='dateModified' content='2017-05-18T21:43:30Z'>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p><code>hijack</code> needs to have the new function return the same type as the original function so we need to change the new function to be a <code>proc</code></p>
<pre><code>    so-print: procedure [
    "Switch between using a print or a so-print operation for the bot"
    val [logic!]
][
    write %so-print.txt copy ""
    either val [
        print "so-print is now on"
        hijack 'write-stdout proc [value][
            write/append %so-print.txt value
        ]
    ][
        hijack 'write-stdout :old-write-stdout
    ]
]</code></pre>
        </div>

        <meta itemprop='headline' content='Getting an error on hijacking write-stdout'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="32.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2017-05-18T21:50:43Z' class='post-time'>
                May 18, 2017,  9:50pm
              </time>
              <meta itemprop='dateModified' content='2017-05-18T21:50:43Z'>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>In debug builds, the message  <em>"managed series was likely created during evaluator tick..."</em> is something you get when a "panic" condition is met.  Panics are like Assertion Failures, but can carry more information to help diagnose the problem.  If you are running a tool like Address Sanitizer or Valgrind, then you'll get significantly more information.</p>
<aside class="onebox githubblob">
  <header class="source">
      <a href="https://github.com/metaeducation/ren-c/blob/d503c1db5546aab94ade9886e34681403655e862/src/include/sys-trap.h#L330" target="_blank" rel="nofollow noopener">github.com</a>
  </header>
  <article class="onebox-body">
    <h4><a href="https://github.com/metaeducation/ren-c/blob/d503c1db5546aab94ade9886e34681403655e862/src/include/sys-trap.h#L330" target="_blank" rel="nofollow noopener">metaeducation/ren-c/blob/d503c1db5546aab94ade9886e34681403655e862/src/include/sys-trap.h#L330</a></h4>
<pre class="onebox"><code class="lang-h"><ol class="start lines" start="320" style="counter-reset: li-counter 319 ;">
<li>                TG_Erroring_C_File = __FILE__; \</li>
<li>                TG_Erroring_C_Line = __LINE__; \</li>
<li>                Fail_Core(error); \</li>
<li>            } while (0)</li>
<li>    #endif</li>
<li>#endif</li>
<li>
</li>
<li>
</li>
<li>//=////////////////////////////////////////////////////////////////////////=//</li>
<li>//</li>
<li class="selected">// PANIC (Force System Exit with Diagnostic Info)</li>
<li>//</li>
<li>//=////////////////////////////////////////////////////////////////////////=//</li>
<li>//</li>
<li>// Panics are the equivalent of the "blue screen of death" and should never</li>
<li>// happen in normal operation.  Generally, it is assumed nothing under the</li>
<li>// user's control could fix or work around the issue, hence the main goal is</li>
<li>// to provide the most diagnostic information possible.</li>
<li>//</li>
<li>// So the best thing to do is to pass in whatever REBVAL* or REBSER* subclass</li>
<li>// (including REBARR*, REBCTX*, REBFUN*...) is the most useful "smoking gun":</li>
</ol></code></pre>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>The problem you've run into here is that the REPL depends on PRINT deeply, and PRINT depends on WRITE-STDOUT.  If you make a mistake in hijacking the behavior of PRINT it is a more serious kind of error, because it will fail at first and then fail during the report.  Basically, it will create an unrecoverable error  to break the version of PRINT that the console depends on.</p>
<p>There is some fledgling work at a "userspace echo" which does what you are trying to do:</p>
<pre><code>&gt;&gt; echo on

&gt;&gt; 1 + 2
== 3

&gt;&gt; 3 + 4
== 7

&gt;&gt; echo off

&gt;&gt; read/lines %echo.txt
== [
    ""
    "&gt;&gt; 1 + 2"
    "== 3"
    ""
    "&gt;&gt; 3 + 4"
    "== 7"
    ""
    "&gt;&gt; echo off"
]

&gt;&gt; echo "cat"

&gt;&gt; 'meow 'meow
== meow

&gt;&gt; echo off

&gt;&gt; read/lines %echo-cat.txt
== [
    ""
    "&gt;&gt; 'meow 'meow"
    "== meow"
    ""
    "&gt;&gt; echo off"
]

&gt;&gt; echo [%custom * %-format.log]

&gt;&gt; echo on

&gt;&gt; "use blocks for templates"
== "use blocks for templates"

&gt;&gt; echo off

&gt;&gt; read/lines %custom-cat-format.log
== [
    ""
    "&gt;&gt; echo on"
    ""
    {&gt;&gt; "use blocks for templates"}
    {== "use blocks for templates"}
    ""
    "&gt;&gt; echo off"
]

&gt;&gt; echo reset

&gt;&gt; read/lines %custom-cat-format.log
== []
</code></pre>
<p>Truly writing a good echo requires tighter cooperation with the console code.  The console is userspace (written in Rebol), so this is something interested users can work on improving:</p>
<aside class="onebox githubblob">
  <header class="source">
      <a href="https://github.com/metaeducation/ren-c/blob/d503c1db5546aab94ade9886e34681403655e862/src/os/host-console.r#L42" target="_blank" rel="nofollow noopener">github.com</a>
  </header>
  <article class="onebox-body">
    <h4><a href="https://github.com/metaeducation/ren-c/blob/d503c1db5546aab94ade9886e34681403655e862/src/os/host-console.r#L42" target="_blank" rel="nofollow noopener">metaeducation/ren-c/blob/d503c1db5546aab94ade9886e34681403655e862/src/os/host-console.r#L42</a></h4>
<pre class="onebox"><code class="lang-r"><ol class="start lines" start="32" style="counter-reset: li-counter 31 ;">
<li>;</li>
<li>; !!! The features that tie the echo specifically to the console would be</li>
<li>; things like ECHO INPUT, e.g.:</li>
<li>;</li>
<li>; https://github.com/red/red/issues/2487</li>
<li>;</li>
<li>; They are not implemented yet, but ECHO is moved here to signify the known</li>
<li>; issue that the CONSOLE must collaborate specifically with ECHO to achieve</li>
<li>; this.</li>
<li>;</li>
<li class="selected">echo: procedure [</li>
<li>    {Copies console I/O to a file.}</li>
<li>
</li>
<li>    'instruction [file! string! block! word!]</li>
<li>        {File or template with * substitution, or command: [ON OFF RESET].}</li>
<li>
</li>
<li>    &lt;has&gt;</li>
<li>    target ([%echo * %.txt])</li>
<li>    form-target</li>
<li>    sub ("")</li>
<li>    old-input (copy :input)</li>
</ol></code></pre>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Getting an error on hijacking write-stdout'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/rgchris'><span itemprop='name'>rgchris</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="32.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2017-07-08T19:51:51Z'>
              <time itemprop='dateModified' datetime='2017-07-08T19:53:11Z' class='post-time'>
                July 8, 2017,  7:53pm
              </time>
          <span itemprop='position'>#4</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Is it still a target to make STDOUT a port (presumably the default for SYSTEM/PORTS/OUTPUT)? I'd assume that you could just say <code>system/ports/output: open %so-print.txt</code></p>
        </div>

        <meta itemprop='headline' content='Getting an error on hijacking write-stdout'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/categories' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/guidelines' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  
</html>
