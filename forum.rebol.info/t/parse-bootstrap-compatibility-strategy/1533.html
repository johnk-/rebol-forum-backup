<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>PARSE Bootstrap Compatibility Strategy - Parsing - AltRebol</title>
    <meta name="description" content="Working with assignments in UPARSE via SET-WORD!s has convinced me that it&amp;#39;s the right strategy. 
I was a little hesitant before because it might make PARSE code &amp;quot;look too much like DO code&amp;quot;.  But the reality seems to su&amp;hellip;">
    <meta name="generator" content="Discourse 2.7.0.beta4 - https://github.com/discourse/discourse version 3fc72543de22c329cf2156f28b781821adc496ae">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/cbd70027b53fa165575e5b665f00eb3b8ae7ea31_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="1533.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.rebol.info","potentialAction":{"@type":"SearchAction","target":"https://forum.rebol.info/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="AltRebol Search">

      <link href="https://forum.rebol.info/stylesheets/desktop_e71c7b3a0694e7f6434c54a663bfb42821f8bd81.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="desktop" />
    
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;PARSE Bootstrap Compatibility Strategy&#39;" href="1533.rss" />
    <meta property="og:site_name" content="AltRebol" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:url" content="https://forum.rebol.info/t/parse-bootstrap-compatibility-strategy/1533" />
<meta name="twitter:url" content="https://forum.rebol.info/t/parse-bootstrap-compatibility-strategy/1533" />
<meta property="og:title" content="PARSE Bootstrap Compatibility Strategy" />
<meta name="twitter:title" content="PARSE Bootstrap Compatibility Strategy" />
<meta property="og:description" content="Working with assignments in UPARSE via SET-WORD!s has convinced me that it&#39;s the right strategy.  I was a little hesitant before because it might make PARSE code &quot;look too much like DO code&quot;.  But the reality seems to suggest that&#39;s not so much of an issue.  At least...if you have a problem with dialects looking &quot;kind of like other Rebol code because it uses the same bricks&quot;...you are kind of out of luck, because that reuse is the idea of the language.  I&#39;ve gone ahead and made the changes to PA..." />
<meta name="twitter:description" content="Working with assignments in UPARSE via SET-WORD!s has convinced me that it&#39;s the right strategy.  I was a little hesitant before because it might make PARSE code &quot;look too much like DO code&quot;.  But the reality seems to suggest that&#39;s not so much of an issue.  At least...if you have a problem with dialects looking &quot;kind of like other Rebol code because it uses the same bricks&quot;...you are kind of out of luck, because that reuse is the idea of the language.  I&#39;ve gone ahead and made the changes to PA..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="1 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="3 ❤" />
<meta property="article:published_time" content="2021-03-03T03:38:19+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="https://forum.rebol.info/">
          <img src="../../uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" alt="AltRebol" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="1533.html">PARSE Bootstrap Compatibility Strategy</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/domains/15" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #F1592A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Domains</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/domains/parsing/16" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #F1592A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Parsing</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="1533.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-03-03T03:38:19Z' class='post-time'>
                March 3, 2021,  3:38am
              </time>
              <meta itemprop='dateModified' content='2021-03-03T03:38:19Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Working with assignments in UPARSE via SET-WORD!s has convinced me that it's the right strategy.</p>
<p>I was a little hesitant before because it might make PARSE code "look too much like DO code".  But the reality seems to suggest that's not so much of an issue.  At least...if you have a problem with dialects looking "kind of like other Rebol code because it uses the same bricks"...you are kind of out of luck, because that reuse <em>is</em> the idea of the language.</p>
<p><a href="https://github.com/metaeducation/ren-c/pull/1115">I've gone ahead and made the changes to PARSE for capturing positions with <strong>POS: HERE</strong> and for seeking positions with <strong>SEEK POS</strong>.</a></p>
<p>For the moment, any other usage of a "lone" SET-WORD! will cause an error.  It will be like that for a little while to help catch violations.</p>
<blockquote>
<p>Note: HERE is more useful than just capturing with SET-WORD!.  Because a rule which evaluates to the current position can be used in places that take more than one rule.</p>
<p>Imagine you wanted to use it with BETWEEN:</p>
<pre><code> parse "&lt;&lt;&lt;stuff&gt;&gt;&gt;" [
     left: copy some "&lt;"
     (n: length of left)
     x: between here n "&gt;"
 ]
</code></pre>
<p>So this wants to count the number of less-than signs, and then match an equal number of greater-than signs.  HERE can serve as a rule for the left side of the capture, to say "just use the current position for the left rule".</p>
</blockquote>
<h2>How To Deal With Bootstrap?</h2>
<p>For most people, the change should be easy, and make code look better.  (Be sure to take the opportunity to see how much nicer COMMA! can make things.)</p>
<p>For bootstrap, it's trickier.  What I have hacked up so far is that anywhere there is a <strong>:pos</strong> in the code, change that to <strong>seek :pos</strong>.  Then, bootstrap code just has to define SEEK to a no-op rule.  That way it will work in both old and new executables.</p>
<p>Similarly, HERE can be defined to a no-op rule in bootstrap.  This way <strong>pos: here</strong> will behave as capturing the position under either behavior.</p>
<p>The bootstrap executable allows SET-WORD! to come after a SET.  So during the compatibility period, we would just allow SET FOO: to act the same as FOO:.</p>
<p>I do not think PARSE COLLECT is used in bootstrap, so changing it from COLLECT DATA: to DATA: COLLECT shouldn't matter.</p>
<p>The tricky case is COPY.  COPY X: would just have to stay a synonym for X: COPY.  It's easy enough to recognize.  The deal would be that you just have to use a SET-WORD! after copy in the bootstrap executable instead of a plain word which could be a rule in the new world.</p>
<p>Anyway, there's been a long uncertain period of "is changing the operators a good idea or not"...so once I was convinced it is a good idea, the sooner the change starts the better.</p>
        </div>

        <meta itemprop='headline' content='PARSE Bootstrap Compatibility Strategy'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="1533.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2021-11-29T07:21:27Z'>
              <time itemprop='dateModified' datetime='2021-11-29T17:43:50Z' class='post-time'>
                November 29, 2021,  5:43pm
              </time>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="hostilefork" data-post="1" data-topic="1533">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/hostilefork/40/26_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<p>For bootstrap, it's trickier. What I have hacked up so far is that anywhere there is a <strong>:pos</strong> in the code, change that to <strong>seek :pos</strong>. Then, bootstrap code just has to define SEEK to a no-op rule. That way it will work in both old and new executables.</p>
<p>Similarly, HERE can be defined to a no-op rule in bootstrap. This way <strong>pos: here</strong> will behave as capturing the position under either behavior.</p>
</blockquote>
</aside>
<p>Sometimes we make mistakes and realize there's better ideas... and this is one of those cases...</p>
<p><strong>New plan: Compatibility PARSE2.</strong></p>
<p>Since UPARSE is going to have the ability to use a set of combinators that make it act like Red or R3-Alpha (so-called UPARSE2) there's no good reason to be throwing in these hacks.</p>
<p>Instead I'm saying that PARSE2 is a mode of the old native parse codebase to act like it used to.  If you want the old behavior (e.g. plain SET-WORD! marks location into a variable, no need for <code>&lt;here&gt;</code>) then use PARSE2.</p>
<p>So the bootstrap executable will just define PARSE2 as its PARSE.</p>
<p>Significantly less confusing, and this makes it easier to be aggressive in aligning the native PARSE with the superior designs that are coming out of UPARSE, as the codebases are merged.</p>
<p>But to make it easier to find these assignments and upgrading, I'm stylizing them.</p>
<pre><code>; old bootstrap code might say this
parse "aaa" [pos: some "a"]

; new bootstrap code breaks these to their own line with comment
parse2 "aaa" [
    pos:  ; &lt;here&gt;
    some "a"
]
</code></pre>
<p>Then fix them up later.</p>
        </div>

        <meta itemprop='headline' content='PARSE Bootstrap Compatibility Strategy'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/categories' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/guidelines' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  
</html>
