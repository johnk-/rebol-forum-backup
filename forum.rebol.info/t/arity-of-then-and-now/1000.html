<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>ARITY-OF: Then and Now - Show &amp; Tell - AltRebol</title>
    <meta name="description" content="I’m going to have to start getting kind of brutal cutting dicey things out of the system for Beta/One.  So when I ran across the ARITY-OF routine and all its disclaimers and concerns, I thought “oh no, well this simple-s&amp;hellip;">
    <meta name="generator" content="Discourse 2.7.0.beta4 - https://github.com/discourse/discourse version 3fc72543de22c329cf2156f28b781821adc496ae">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/cbd70027b53fa165575e5b665f00eb3b8ae7ea31_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="1000.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.rebol.info","potentialAction":{"@type":"SearchAction","target":"https://forum.rebol.info/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="AltRebol Search">

      <link href="https://forum.rebol.info/stylesheets/desktop_e71c7b3a0694e7f6434c54a663bfb42821f8bd81.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="desktop" />
    
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;ARITY-OF: Then and Now&#39;" href="1000.rss" />
    <meta property="og:site_name" content="AltRebol" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:url" content="https://forum.rebol.info/t/arity-of-then-and-now/1000" />
<meta name="twitter:url" content="https://forum.rebol.info/t/arity-of-then-and-now/1000" />
<meta property="og:title" content="ARITY-OF: Then and Now" />
<meta name="twitter:title" content="ARITY-OF: Then and Now" />
<meta property="og:description" content="I&#39;m going to have to start getting kind of brutal cutting dicey things out of the system for Beta/One.  So when I ran across the ARITY-OF routine and all its disclaimers and concerns, I thought &quot;oh no, well this simple-seeming thing is more trouble than it&#39;s worth, to explain and document...&quot;  Classical Rebol doesn&#39;t have it.  People who want to know the arity of a function have to get WORDS OF the function, then count up to the first refinement, and then say &quot;done&quot;.  But you&#39;re not done, becaus..." />
<meta name="twitter:description" content="I&#39;m going to have to start getting kind of brutal cutting dicey things out of the system for Beta/One.  So when I ran across the ARITY-OF routine and all its disclaimers and concerns, I thought &quot;oh no, well this simple-seeming thing is more trouble than it&#39;s worth, to explain and document...&quot;  Classical Rebol doesn&#39;t have it.  People who want to know the arity of a function have to get WORDS OF the function, then count up to the first refinement, and then say &quot;done&quot;.  But you&#39;re not done, becaus..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="1 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="2 ❤" />
<meta property="article:published_time" content="2019-01-07T21:35:55+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="https://forum.rebol.info/">
          <img src="../../uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" alt="AltRebol" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="1000.html">ARITY-OF: Then and Now</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/usage/7" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #3AB54A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Usage</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/usage/show-and-tell/33" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #3AB54A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Show &amp; Tell</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="1000.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2019-01-07T21:35:55Z'>
              <time itemprop='dateModified' datetime='2019-01-07T22:43:22Z' class='post-time'>
                January 7, 2019, 10:43pm
              </time>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I'm going to have to start getting kind of brutal cutting dicey things out of the system for Beta/One.  So when I ran across the ARITY-OF routine and <a href="https://github.com/metaeducation/ren-c/blob/34aa979003554fccc87482098ee817b0e401f59a/src/mezz/base-funcs.r#L678" rel="nofollow noopener">all its disclaimers and concerns</a>, I thought <em>"oh no, well this simple-seeming thing is more trouble than it's worth, to explain and document..."</em></p>
<p>Classical Rebol doesn't have it.  People who want to know the arity of a function have to get WORDS OF the function, then count up to the first refinement, and then say "done".</p>
<p>But you're not done, because if you're processing source you might have seen something like APPEND/DUP/PART.  How do you ask for the arity of that, without calling it?  Massive unsolved problem.</p>
<h2>But, wait a minute...</h2>
<p>It was unsolved <em>back then</em>.  But there's a lot to be said for doing things right.  <img src="../../images/emoji/twitter/man_mechanic.png%3Fv=7" title=":man_mechanic:" class="emoji" alt=":man_mechanic:"></p>
<pre><code>&gt;&gt; parameters of :append
== [series value /part limit /only /dup count /line]

&gt;&gt; parameters of :append/dup
== [series value count /part limit /only /line]

&gt;&gt; parameters of :append/part
== [series value limit /only /dup count /line]

&gt;&gt; parameters of :append/part/dup
== [series value limit count /only /line]

&gt;&gt; parameters of :append/dup/part
== [series value count limit /only /line]
</code></pre>
<h2>...and so all we have to write is....</h2>
<pre><code>arity-of: function [
    "Get the number of fixed arguments to an ACTION! (if not variadic)"
    return: [integer!]
    action [action!]
][
    if variadic? :action [
        fail "ARITY-OF cannot give an answer for variadic actions"
    ]
    arity: 0
    for-each p parameters of :action [
        if refinement? :p [break]
        arity: arity + 1
    ]
    return arity
]
</code></pre>
<p>Exercise for the reader: try doing this in Rebol2/R3-Alpha/Red <img src="https://forum.rebol.info/images/emoji/twitter/slight_smile.png?v=7" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<pre><code>&gt;&gt; map-each x [
          append append/dup append/part append/dup/part append/part/dup
     ][
          arity-of get x
    ]
== [2 3 3 4 4]</code></pre>
        </div>

        <meta itemprop='headline' content='ARITY-OF: Then and Now'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="1000.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2019-01-07T22:26:18Z'>
              <time itemprop='dateModified' datetime='2019-01-07T22:29:38Z' class='post-time'>
                January 7, 2019, 10:29pm
              </time>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <h2>But I'm still going to cut ARITY-OF from Core</h2>
<p>Here's why:</p>
<pre><code> &gt;&gt; foo: func ['x 'y] [...]
 &gt;&gt; arity-of :foo
 == 2

 &gt;&gt; bar: func [x y] [...]
 &gt;&gt; arity-of :bar
 == 2
</code></pre>
<p>What good is this number going to do anyone?  You can't use it to know how many things would be taken spliced after something, you need to know if the arguments are quoted.  Tightness and non-tightness affects things too.</p>
<p>You have to look at the specific PARAMETERS OF and understand what part of that is important to what you are doing.  We're not necessarily doing anyone any favors by trying to digest and oversimplify what's in there.</p>
<p><strong>It's still nice to point out how today, you can start from a PATH! and get to an ACTION!, and from there get to a PARAMETERS OF that is meaningful.</strong>  <em>It's a huge improvement.</em>  But now that you have that information, you need to integrate it with what you're trying to accomplish with your reflection.</p>
<h2>Some other little routines are getting cut too...</h2>
<p>These guys have the same problem.  Tight or non-tight parameter conventions can make two seemingly INFIX? functions be very different.  So what did you actionably learn from that oversimplification?</p>
<pre><code>nfix?: function [
    n [integer!]
    name [text!]
    source [any-word! any-path!]
][
    case [
        not enfixed? source [false]
        equal? n arity: arity-of source [true]
        n &lt; arity [
            ; If the queried arity is lower than the arity of the function,
            ; assume it's ok...e.g. PREFIX? callers know INFIX? exists (but
            ; we don't assume INFIX? callers know PREFIX?/ENDFIX? exist)
            false
        ]
    ] else [
        fail [
            name "used on enfixed function with arity" arity
                |
            "Use ENFIXED? for generalized (tricky) testing"
        ]
    ]
]

postfix?: redescribe [
    {TRUE if an arity 1 function is SET/ENFIX to act as postfix.}
](
    specialize :nfix? [n: 1 | name: "POSTFIX?"]
)

infix?: redescribe [
    {TRUE if an arity 2 function is SET/ENFIX to act as infix.}
](
    specialize :nfix? [n: 2 | name: "INFIX?"]
)
</code></pre>
<p>I don't feel bad cutting these, so long as it's easy enough to write what you mean for your purpose.</p>
        </div>

        <meta itemprop='headline' content='ARITY-OF: Then and Now'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/categories' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/guidelines' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  
</html>
