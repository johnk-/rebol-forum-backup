<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Syntax for Subverting Virtual Binding - #8 by hostilefork - Binding - AltRebol</title>
    <meta name="description" content="In the closing weeks of 2020, I&amp;#39;ve been committing myself to &amp;quot;Virtual Binding&amp;#39;s Last Stand&amp;quot;.  The results are encouraging.  While it&amp;#39;s a bit premature to declare that &amp;quot;it works!&amp;quot;...it can bootstrap itself and run the tes&amp;hellip;">
    <meta name="generator" content="Discourse 2.7.0.beta4 - https://github.com/discourse/discourse version 3fc72543de22c329cf2156f28b781821adc496ae">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/1X/cbd70027b53fa165575e5b665f00eb3b8ae7ea31_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../1444.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.rebol.info","potentialAction":{"@type":"SearchAction","target":"https://forum.rebol.info/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="AltRebol Search">

      <link href="https://forum.rebol.info/stylesheets/desktop_e71c7b3a0694e7f6434c54a663bfb42821f8bd81.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="desktop" />
    
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Syntax for Subverting Virtual Binding&#39;" href="../1444.rss" />
    <meta property="og:site_name" content="AltRebol" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:url" content="https://forum.rebol.info/t/syntax-for-subverting-virtual-binding/1444/8" />
<meta name="twitter:url" content="https://forum.rebol.info/t/syntax-for-subverting-virtual-binding/1444/8" />
<meta property="og:title" content="Syntax for Subverting Virtual Binding" />
<meta name="twitter:title" content="Syntax for Subverting Virtual Binding" />
<meta property="og:description" content="I&#39;ll point out that this is yet another defeat to the idea of using a BLOCK! the state for single-stepping.  let [x &#39;y]: whatever  If you single step, the LET will create a virtual binding for X and leave Y alone.  Then LET itself vanishes.  What remains is:  [x y]: whatever  ; with virtual binding on x  If the evaluator is limited to having to return the state in terms of a position in the original block, it wouldn&#39;t have the option of giving this back as the state for the next step... since t..." />
<meta name="twitter:description" content="I&#39;ll point out that this is yet another defeat to the idea of using a BLOCK! the state for single-stepping.  let [x &#39;y]: whatever  If you single step, the LET will create a virtual binding for X and leave Y alone.  Then LET itself vanishes.  What remains is:  [x y]: whatever  ; with virtual binding on x  If the evaluator is limited to having to return the state in terms of a position in the original block, it wouldn&#39;t have the option of giving this back as the state for the next step... since t..." />
<meta property="article:published_time" content="2021-02-16T12:17:02+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="https://forum.rebol.info/">
          <img src="../../../uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" alt="AltRebol" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="../1444.html">Syntax for Subverting Virtual Binding</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/development/8" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/development/binding/49" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Binding</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../1444.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2020-12-29T14:45:24Z'>
              <time itemprop='dateModified' datetime='2020-12-29T15:43:57Z' class='post-time'>
                December 29, 2020,  3:43pm
              </time>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>In the closing weeks of 2020, I've been committing myself to <em>"Virtual Binding's Last Stand"</em>.  The results are encouraging.  While it's a bit premature to declare that "it works!"...it can bootstrap itself and run the tests without crashing.  (This is with applying virtual binding to all XXX-EACH, USE, and MAKE OBJECT! cases.)</p>
<p>Despite the fact that what I have now is kind of the most clunky form of itself, it hasn't degraded performance noticeably.    Unfortunately, the main reason it looks so acceptable <strong>is because the method it was using from R3-Alpha there before really, really sucked.</strong></p>
<p>Anyway...no matter how good virtual binding gets, it will always have more cost than referring to a fixed variable.  So if you have a variable you want to reuse, we need a way to say that.</p>
<h2>Red's "Idea": Reusing Variables is the Default (and only) option</h2>
<p>Here's how Red rolls:</p>
<pre><code> red&gt;&gt; print-nums: func [] [foreach x [1 2 3] [print ["Value is" x]]]

 red&gt;&gt; x: 10

 red&gt;&gt; print-nums

 red&gt;&gt; x
 == 3
</code></pre>
<p>So DocKimbel's answer to the performance and semantic inconvenience of copying-and-rebinding the loop body is "ignore it".  You have to define the variable.</p>
<pre><code> red&gt;&gt; print-nums: func [/local x] [foreach x [1 2 3] [print ["Value is" x]]]

 red&gt;&gt; x: 10

 red&gt;&gt; print-nums

 red&gt;&gt; x
 == 10
</code></pre>
<p>This is different from Rebol2 and R3-Alpha, which bear the cost of allocating a new variable, and then copying and rebinding the body to it:</p>
<pre><code>rebol2&gt;&gt; body: [append [] &lt;test&gt;]
rebol2&gt;&gt; foreach x [1 2] body
rebol2&gt;&gt; body
== [append [] &lt;test&gt;]

red&gt;&gt; body: [append [] &lt;test&gt;]
red&gt;&gt; foreach x [1 2] body
red&gt;&gt; body
== [append [&lt;test&gt; &lt;test&gt;] &lt;test&gt;]
</code></pre>
<p><em>(As a point on why this is semantically slippery, notice I didn't say <strong><code>body: [insert body &lt;test&gt;]</code></strong> in the Rebol2 case.  The reason is that since the body is copied, you don't have a name for the loop's copy of the body to see the effects on it... so that would change the original body.  You have to modify an array stored inside the body to see what's going on.  Just another point of complexity in making copies behind-the-scenes...)</em></p>
<h2>Red's Choice is a Bad Default (right?)... but it should be an Option</h2>
<p>Even though virtual binding does not copy the body, it won't be without cost.  (Its existence isn't really about performance primarily anyway...it's about semantics, and not corrupting block bindings on a whim.)</p>
<p>So you should have a way of asking to just use an existing variable if you need to.</p>
<p>Early on I used quoted words as a way of telling the FOR-EACH to reuse a variable:</p>
<pre><code> print-nums: func [&lt;local&gt; x] [
     for-each 'x [1 2 3] [print ["Value is" x]]]
 ]
</code></pre>
<p>When using a BLOCK! spec, you could mix and match...so some fields were reused and others were part of a generated object:</p>
<pre><code> print-nums: func [&lt;local&gt; x] [
     for-each ['x y] [1 2 3 4] [print [x y]]]
 ]
</code></pre>
<p>But I've mentioned that for reasons of one's "formal" senses (or necessary suppressing the behavior of a left-quoting WORD!) that you might want to use quoted words as the argument to FOR-EACH anyway.  On top of that, I don't know that we've come to a full consensus that it shouldn't be required...though I'm leaning heavily to saying it shouldn't be.</p>
<p>So what other choices are there?  GET-WORD! is already taken to mean <em>"subvert quoting, this word holds the name of the variable(s) to use"</em>... so <strong>for-each :x</strong> is a shorthand for as a shorthand for <strong>for-each :(x)</strong></p>
<pre><code>for-each /x [...] [...]
for-each .x [...] [...]
for-each @x [...] [...]
</code></pre>
<p>None of these really scream "use an existing variable" to me.  And <strong>for-each/reuse</strong> wouldn't let you mix and match.</p>
<p>The spec dialect itself could be fancier...maybe importing things <code>#with</code>, and you could use commas to break it up:</p>
<pre><code>for-each [#with x] [...] [...]  ; reuse X
for-each [#with x, y] [...] [...]  ; reuse X, virtual bind Y
for-each [#with x y] [...] [...]  ; both X and Y are reused
</code></pre>
<h2>Any Other Ideas?  Comments?</h2>
<p>I'm going to assume everyone agrees that virtual binding should be the default, giving a Rebol2/R3-Alpha-like experience.  If you didn't agree with that, and wanted Red's behavior as default, you might suggest things like <strong>for-each x: [...]</strong> to request a new variable.  But that's flat-out confusing, and <strong>for-each 'x: [...]</strong> isn't much of an improvement.</p>
<p>I'm kind of bummed the distinction of <strong>for-each x</strong> vs. <strong>for-each 'x</strong> isn't an option.  Something about that seemed nice and clean.</p>
<p>We're still shaping up exactly what the @-family does...in particular if it's going to mean anything w.r.t. datatypes.  Maybe that's not its destiny.  So best option is probably going to be <strong>for-each <span class="mention">@x</span></strong>.  It leans somewhat on the "as-is" meaning (use the variable as-is).</p>
<p>You won't expect to see this all that often, unless someone is trying to optimize something for performance.</p>
        </div>

        <meta itemprop='headline' content='Syntax for Subverting Virtual Binding'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/rgchris'><span itemprop='name'>rgchris</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../1444.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-12-29T17:07:07Z' class='post-time'>
                December 29, 2020,  5:07pm
              </time>
              <meta itemprop='dateModified' content='2020-12-29T17:07:07Z'>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I'm not quite clear why <strong>for-each x</strong> vs <strong>for-each 'x</strong> isn't an option—it does seem like the cleanest choice.</p>
        </div>

        <meta itemprop='headline' content='Syntax for Subverting Virtual Binding'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../1444.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-12-29T17:27:00Z' class='post-time'>
                December 29, 2020,  5:27pm
              </time>
              <meta itemprop='dateModified' content='2020-12-29T17:27:00Z'>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="rgchris" data-post="2" data-topic="1444">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/rgchris/40/14_2.png" class="avatar"> rgchris:</div>
<blockquote>
<p>why <strong>for-each x</strong> vs <strong>for-each 'x</strong> isn't an option</p>
</blockquote>
</aside>
<p>Please see <strong><a href="../../speaking-with-tics-should-quoted-arguments-always-be-apostrophed/1359.html">"Speaking With Tics"</a></strong> (and have an opinion on it!)</p>
        </div>

        <meta itemprop='headline' content='Syntax for Subverting Virtual Binding'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/rgchris'><span itemprop='name'>rgchris</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../1444.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2020-12-29T18:12:55Z'>
              <time itemprop='dateModified' datetime='2020-12-29T18:17:52Z' class='post-time'>
                December 29, 2020,  6:17pm
              </time>
          <span itemprop='position'>#4</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>My conservative hat would say that the proposals therein aren't worth the cleaner expression up front. It's difficult to be certain due to a dearth of code written with those idioms—they may arguably be more expressive on the whole, but they come at a cost.</p>
<p>That said, I'm not wholly a conservative (that's just the part that is still only productive in Rebol 2), I'm open to seeing how this would resolve.</p>
        </div>

        <meta itemprop='headline' content='Syntax for Subverting Virtual Binding'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../1444.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-12-29T20:14:34Z' class='post-time'>
                December 29, 2020,  8:14pm
              </time>
              <meta itemprop='dateModified' content='2020-12-29T20:14:34Z'>
          <span itemprop='position'>#5</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="rgchris" data-post="4" data-topic="1444">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/rgchris/40/14_2.png" class="avatar"> rgchris:</div>
<blockquote>
<p>My conservative hat would say that the proposals therein aren't worth the cleaner expression up front.</p>
</blockquote>
</aside>
<p>Helps to be more specific.  It's a long post.</p>
<p>You think <strong>t: 'type of x</strong> is preferable on the whole to <strong>t: type of x</strong>?</p>
<p>I'd think that you would side on the idea that words should be the currency with as little decoration as possible.</p>
        </div>

        <meta itemprop='headline' content='Syntax for Subverting Virtual Binding'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/rgchris'><span itemprop='name'>rgchris</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../1444.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-12-29T21:58:55Z' class='post-time'>
                December 29, 2020,  9:58pm
              </time>
              <meta itemprop='dateModified' content='2020-12-29T21:58:55Z'>
          <span itemprop='position'>#6</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="hostilefork" data-post="5" data-topic="1444">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/hostilefork/40/26_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<p>You think <strong>t: 'type of x</strong> is preferable on the whole to <strong>t: type of x</strong>?</p>
</blockquote>
</aside>
<p>I'd say if <strong>type of</strong> pushes the cost of clarity elsewhere, then it's more problematic that it's worth.</p>
<p>If <strong>for-each 'thing [...] [...]</strong> is the natural way to express this behaviour (which it seems so to me—at least compared to the alternatives), then it'd be worth revisiting <strong>type of</strong>.</p>
<aside class="quote no-group" data-username="hostilefork" data-post="5" data-topic="1444">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/hostilefork/40/26_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<p>I'd think that you would side on the idea that words should be the currency with as little decoration as possible.</p>
</blockquote>
</aside>
<p>I do. I see quoted words in the <strong>for-each</strong> example as a reasonable tradeoff to express the difference in behaviour moderately consistent with other uses in the language—especially if that is the exceptional case.</p>
        </div>

        <meta itemprop='headline' content='Syntax for Subverting Virtual Binding'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../1444.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-02-10T08:53:47Z' class='post-time'>
                February 10, 2021,  8:53am
              </time>
              <meta itemprop='dateModified' content='2021-02-10T08:53:47Z'>
          <span itemprop='position'>#7</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="hostilefork" data-post="1" data-topic="1444">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/hostilefork/40/26_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<p>Early on I used quoted words as a way of telling the FOR-EACH to reuse a variable:</p>
<pre><code>print-nums: func [&lt;local&gt; x] [
     for-each 'x [1 2 3] [print ["Value is" x]]]
]
</code></pre>
</blockquote>
</aside>
<p>This question of a syntax for subverting virtual binding comes up again when doing LET, due to multiple returns.</p>
<p>If you want to define two all new variables to receive the results of some calculation, that can work:</p>
<pre><code>let [value pos]: parse "aaaabbb" [some "a"]
</code></pre>
<p>But what if only <em>one</em> of these variables is new, and you want the other to be assigned to the existing binding?  You need some way of using the position, but escaping the LET.</p>
<p>Quoting words remains a possibility.</p>
<pre><code>let [value 'pos]: parse "aaaabbb" [some "a"]
</code></pre>
<p>Which would wind up acting like:</p>
<pre><code>let value
[value pos]: parse "aaaabbb" [some "a"]
</code></pre>
<p><strong>I've gone ahead and implemented this.</strong>  The more general rule is that whatever it is you quote gets unquoted by one level...the LET assumes the quoted thing is not for its consumption, but for whatever is going to be consuming the SET-BLOCK! later.  That could be a multi-return, or anything else that left-quotes SET-BLOCK!s.</p>
<hr>
<p>If this sticks, it would be consistent if the FOR constructs discerned ticks on the argument to mean "reuse".  If you put a tick on a GROUP! that could mean to reuse a calculated variable:</p>
<pre><code>for-each (first [x]) [...] [...]   ; create new binding labeled X
for-each '(first [x]) [...] [...]   ; reuse whatever binding is on the X
</code></pre>
<p>There are only two seeming arguments against this:</p>
<ul>
<li>
<p>People might think FOR-EACH 'X makes more sense because you are not "using" the X, and the callsite should reflect that.  Hence FOR-EACH X should either be illegal, or pass in the word/block/whatever that X holds.</p>
</li>
<li>
<p>People might think FOR-EACH 'X and FOR-EACH X should mean the same thing, with people being able to have the tick at the callsite if they know the thing they are using is a left-quoting operation which might otherwise quote the FOR-EACH before the FOR-EACH can quote it.</p>
</li>
</ul>
<p>If you happen across a left-quoting situation, you can still beat it with <strong>for-each ('x)</strong>...or <strong>for-each 'x</strong> if you were planning to reuse the binding anyway.</p>
<p>Anyway...the gravity is now on the side of saying a tick reuses the existing binding.  At least there's a philosophy and explanation behind the choice. <img src="../../../images/emoji/twitter/man_shrugging.png%3Fv=9" title=":man_shrugging:" class="emoji" alt=":man_shrugging:"></p>
        </div>

        <meta itemprop='headline' content='Syntax for Subverting Virtual Binding'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../1444.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-02-16T12:17:02Z' class='post-time'>
                February 16, 2021, 12:17pm
              </time>
              <meta itemprop='dateModified' content='2021-02-16T12:17:02Z'>
          <span itemprop='position'>#8</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="hostilefork" data-post="7" data-topic="1444">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/hostilefork/40/26_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<p>The more general rule is that whatever it is you quote gets unquoted by one level...the LET assumes the quoted thing is not for its consumption, but for whatever is going to be consuming the SET-BLOCK! later. That could be a multi-return, or anything else that left-quotes SET-BLOCK!s.</p>
</blockquote>
</aside>
<p>I'll point out that this is yet another defeat to the idea of using a BLOCK! the state for single-stepping.</p>
<pre><code>let [x 'y]: whatever
</code></pre>
<p>If you single step, the LET will create a virtual binding for X and leave Y alone.  Then LET itself vanishes.  What remains is:</p>
<pre><code>[x y]: whatever  ; with virtual binding on x
</code></pre>
<p>If the evaluator is limited to having to return the state in terms of a position in the original block, it wouldn't have the option of giving this back as the state for the next step... since there is no <code>[x y]:</code> there.  Just <code>[x 'y]:</code></p>
<p>My feeling is that the evidence is pretty strong on the side of saying <a href="../../pivotal-design-question-is-evaluator-state-just-a-block/1496.html">evaluator state should be more flexible than a BLOCK!</a>.  We must keep looking at how to empower code that needs to single-step (I've described ASSERT and TLS EMIT) but accept that what comes back is a FRAME! and not the previous simplistic BLOCK! of a position that the historical DO/NEXT had.</p>
        </div>

        <meta itemprop='headline' content='Syntax for Subverting Virtual Binding'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/categories' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/guidelines' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  
</html>
