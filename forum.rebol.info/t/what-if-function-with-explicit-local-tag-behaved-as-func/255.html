<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>What if FUNCTION with explicit &lt;local&gt; tag behaved as FUNC? - Dialects/DSLs - AltRebol</title>
    <meta name="description" content="The current behavior of FUNCTION with a &amp;lt;local&amp;gt; tag is to let you specify explicit locals, while still gathering SET-WORD!s in the body.  So a hypothetical example would be: 
foo: function [a b &amp;lt;local&amp;gt; c d] [
    set [c &amp;hellip;">
    <meta name="generator" content="Discourse 2.7.0.beta4 - https://github.com/discourse/discourse version 3fc72543de22c329cf2156f28b781821adc496ae">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/cbd70027b53fa165575e5b665f00eb3b8ae7ea31_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="https://forum.rebol.info/t/what-if-function-with-explicit-local-tag-behaved-as-func/255" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.rebol.info","potentialAction":{"@type":"SearchAction","target":"https://forum.rebol.info/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="AltRebol Search">

      <link href="../../stylesheets/desktop_e71c7b3a0694e7f6434c54a663bfb42821f8bd81.css%3F__ws=forum.rebol.info.css" media="all" rel="stylesheet" data-target="desktop" />
    
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;What if FUNCTION with explicit &lt;local&gt; tag behaved as FUNC?&#39;" href="255.rss" />
    <meta property="og:site_name" content="AltRebol" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:url" content="https://forum.rebol.info/t/what-if-function-with-explicit-local-tag-behaved-as-func/255" />
<meta name="twitter:url" content="https://forum.rebol.info/t/what-if-function-with-explicit-local-tag-behaved-as-func/255" />
<meta property="og:title" content="What if FUNCTION with explicit &lt;local&gt; tag behaved as FUNC?" />
<meta name="twitter:title" content="What if FUNCTION with explicit &lt;local&gt; tag behaved as FUNC?" />
<meta property="og:description" content="The current behavior of FUNCTION with a &lt;local&gt; tag is to let you specify explicit locals, while still gathering SET-WORD!s in the body.  So a hypothetical example would be:  foo: function [a b &lt;local&gt; c d] [     set [c d] reduce [a b]     x: c + d     return x ]  The example is kind of dumb, because the SET line could have used set [c: d:] ... in this case and gotten locals gathering behavior.  In any case, the much more common case is to want to suppress locals gathering for a set-word (&lt;with&gt;,..." />
<meta name="twitter:description" content="The current behavior of FUNCTION with a &lt;local&gt; tag is to let you specify explicit locals, while still gathering SET-WORD!s in the body.  So a hypothetical example would be:  foo: function [a b &lt;local&gt; c d] [     set [c d] reduce [a b]     x: c + d     return x ]  The example is kind of dumb, because the SET line could have used set [c: d:] ... in this case and gotten locals gathering behavior.  In any case, the much more common case is to want to suppress locals gathering for a set-word (&lt;with&gt;,..." />
<meta property="article:published_time" content="2017-08-16T01:14:21+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" alt="AltRebol" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="255.html">What if FUNCTION with explicit &lt;local&gt; tag behaved as FUNC?</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/domains/15" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #F1592A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Domains</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/domains/dialects-dsls/18" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #F1592A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Dialects/DSLs</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="https://forum.rebol.info/t/what-if-function-with-explicit-local-tag-behaved-as-func/255">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2017-08-16T01:14:21Z'>
              <time itemprop='dateModified' datetime='2021-01-08T03:54:50Z' class='post-time'>
                January 8, 2021,  3:54am
              </time>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>The current behavior of FUNCTION with a <code>&lt;local&gt;</code> tag is to let you specify explicit locals, while still gathering SET-WORD!s in the body.  So a hypothetical example would be:</p>
<pre><code>foo: function [a b &lt;local&gt; c d] [
    set [c d] reduce [a b]
    x: c + d
    return x
]
</code></pre>
<p>The example is kind of dumb, because the SET line could have used <strong>set [c: d:] ...</strong> in this case and gotten locals gathering behavior.  In any case, the much more common case is to want to suppress locals gathering for a set-word (<code>&lt;with&gt;</code>, formerly known as /EXTERN) than to force locals gathering for non-SET-WORD!s.</p>
<p>FWIW, I've never used <code>&lt;local&gt;</code> with it's current behavior in a FUNCTION.  There's also the ability to use SET-WORD! in the spec to specify locals without disabling locals gathering.  Plus I don't feel like there's a whole lot of uses of FUNC...where FUNCTION vs. FUNC would make a difference...that don't have a /LOCAL in it.</p>
<p>So what if <code>&lt;local&gt;</code> meant don't do locals gathering, and FUNC went away.  What we're really comparing here is:</p>
<pre><code> function [a b &lt;local&gt; c d]
 func [a b &lt;local&gt; c d]
</code></pre>
<p>At which point we're talking about a 4 character difference.  And people who wanted to could abbreviate FUNC for FUNCTION and still get to say they wanted locals gathering or not in the same length while using FUNC for locals gathering also.</p>
<p><a class="mention" href="../../u/rgchris.html">@rgchris</a> has suggested that in cases of functions that are declared inside objects, the ergonomics of having something that doesn't do locals-gathering in order to get at the object fields is important.  But I think there's a lot of work to be done there, with a METHOD that can somehow work with our new binding capabilities to avoid functions that have copies of their bodies made on every instance of an object class made.  It may change the dynamics of that situation entirely.</p>
<p>In any case, I think it would be pleasing if "FUNC" were not necessary or in the box, so it's worth thinking about.</p>
        </div>

        <meta itemprop='headline' content='What if FUNCTION with explicit &lt;local&gt; tag behaved as FUNC?'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/rgchris'><span itemprop='name'>rgchris</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="https://forum.rebol.info/t/what-if-function-with-explicit-local-tag-behaved-as-func/255">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2017-08-16T06:32:01Z'>
              <time itemprop='dateModified' datetime='2017-08-16T06:33:07Z' class='post-time'>
                August 16, 2017,  6:33am
              </time>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Not just objects but also using functions as callbacks where for the most part you want the function operating in the context of origin.</p>
<p>Looking again at <a href="http://rebol.info/rebolsteps.html#section-6" rel="nofollow noopener">ten steps</a>, a function is defined this <em>"... is a block which has local variables that are given new values each time the block is evaluated"</em>. Thinking along these lines <code>func</code> behaviour is the natural way to consider what a function is in Rebol. While auto-gathering helps avoid naive errors, it can lead to unexpected errors when working in more nuanced and complex situations (auto-gathering can only ever be clumsy). I suggest that auto-gathering should require a flag and <code>func</code> behaviour be the default for <code>function</code>.</p>
<p>And a pedantic counter-point, your suggestion is a 12 character difference for a basic <code>func</code>:</p>
<pre><code class="lang-auto">func [foo][...]
function [foo &lt;local&gt;][...]
</code></pre>
        </div>

        <meta itemprop='headline' content='What if FUNCTION with explicit &lt;local&gt; tag behaved as FUNC?'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="https://forum.rebol.info/t/what-if-function-with-explicit-local-tag-behaved-as-func/255">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2017-08-16T08:10:51Z'>
              <time itemprop='dateModified' datetime='2017-08-16T08:13:04Z' class='post-time'>
                August 16, 2017,  8:13am
              </time>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="2" data-topic="255">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forum.rebol.info/rgchris/40/14_2.png" class="avatar"> rgchris:</div>
<blockquote>
<p>auto-gathering can only ever be clumsy</p>
</blockquote>
</aside>
<p>I see your point.  Though I'll also point out you haven't weighed in yet on what I would <em>think</em> would be a similar "clumsiness" of allowing random bindings to escape and lead to <a href="../what-happens-to-function-arguments-and-locals-when-the-call-ends/234.html">indefinite lifetimes of args/refinements/locals</a>!</p>
<p><em>IF</em> Rebol leans more to being an advanced, graspable, human-scale, natural-language-biased assembly language (with a wacky instruction set) than it is an abstract high-level language, it should be erring in these matters on the side of control and awareness.  To keep people close to the "metal" of the reality of the interpreter core, and yet able to accomplish great feats despite that design.</p>
<aside class="quote no-group" data-post="2" data-topic="255">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forum.rebol.info/rgchris/40/14_2.png" class="avatar"> rgchris:</div>
<blockquote>
<p>I suggest that auto-gathering should require a flag and func behaviour be the default for function.</p>
</blockquote>
</aside>
<p>A big thought, and as starting this thread indicates, I'm still encouraging the big thoughts.  (I have not given up on <strong>=</strong> meaning strict equality, and <strong>is</strong> being lax equality, with <strong>isn't</strong> pairing with IS, apostrophe and all.)</p>
<p>So yes, well worth noticing we could bend it the other way...the parallel suggestion would be thus that <code>function [foo &lt;with&gt;] [...]</code> mean "with nothing", e.g. no assignments via-set-word reach out of the environment of the function.</p>
<p>It is true that classic FUNC is the more "basic" tool of Rebol and maybe a mistake to hide it, the other questions aside.  I broke it down even further so that MAKE FUNCTION! is the <em>most</em> basic tool, which does not even define what the word RETURN means.</p>
<p>Lest people feel demoralized by the idea we're still talking about such "basic" questions, I'd like to remind people that today, we can do things like this:</p>
<pre><code> &gt;&gt; do-frame: function [f] [
      do f
      return "not returned from do-frame"
 ]

 &gt;&gt; something: function [y] [
     f: make frame! :return
     f/value: y
     do-frame f
     return "not returned from something"
 ]

 &gt;&gt; something 1020
 == 1020
</code></pre>
<p>I show that off--instead of just the usual "hey you can RETURN out of userspace loops"--because it was even harder to rig up inside the rules of the game.  The pieces are composing, a FRAME! based on a definitional return can reconnect with the specific RETURN it was made for.</p>
<p>The mechanics of how this all can tie together, and the fact that FUNCTION can be built entirely in userspace (with a different term used for RETURN, or variations at your choice), is something that I feel is worth at least a little sense of awe.</p>
<p>So I don't want us to underestimate the value of continuing to push on the ground definitions.  Maybe we not make any big moves until virtual binding advances a bit more, though.  Making headway on that--in my opinion--would be something that changes quite a lot of how we look at the language.</p>
        </div>

        <meta itemprop='headline' content='What if FUNCTION with explicit &lt;local&gt; tag behaved as FUNC?'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../tos.html' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../privacy.html' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  
</html>
