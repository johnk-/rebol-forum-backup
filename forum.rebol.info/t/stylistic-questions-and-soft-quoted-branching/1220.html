<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Stylistic Questions and Soft-Quoted Branching - Show &amp; Tell - AltRebol</title>
    <meta name="description" content="Here is a small implementation of SIGN-OF to look at: 
sign-of: func [
    &amp;quot;Returns sign of number as 1, 0, or -1 (to use as multiplier).&amp;quot;
    number [any-number! money! time!]
][
    case [
        positive? number [1]
&amp;hellip;">
    <meta name="generator" content="Discourse 2.7.0.beta4 - https://github.com/discourse/discourse version 3fc72543de22c329cf2156f28b781821adc496ae">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/cbd70027b53fa165575e5b665f00eb3b8ae7ea31_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="1220.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.rebol.info","potentialAction":{"@type":"SearchAction","target":"https://forum.rebol.info/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="AltRebol Search">

      <link href="https://forum.rebol.info/stylesheets/desktop_e71c7b3a0694e7f6434c54a663bfb42821f8bd81.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="desktop" />
    
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Stylistic Questions and Soft-Quoted Branching&#39;" href="1220.rss" />
    <meta property="og:site_name" content="AltRebol" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:url" content="https://forum.rebol.info/t/stylistic-questions-and-soft-quoted-branching/1220" />
<meta name="twitter:url" content="https://forum.rebol.info/t/stylistic-questions-and-soft-quoted-branching/1220" />
<meta property="og:title" content="Stylistic Questions and Soft-Quoted Branching" />
<meta name="twitter:title" content="Stylistic Questions and Soft-Quoted Branching" />
<meta property="og:description" content="Here is a small implementation of SIGN-OF to look at:  sign-of: func [     &quot;Returns sign of number as 1, 0, or -1 (to use as multiplier).&quot;     number [any-number! money! time!] ][     case [         positive? number [1]         negative? number [-1]         default [0]     ] ]  You could do this with an ELSE if you wished (I&#39;ve mentioned they are nearly the same, but not quite... a SWITCH/ALL will always run the default, but only run the ELSE if at least one branch runs):  case [     positive? n..." />
<meta name="twitter:description" content="Here is a small implementation of SIGN-OF to look at:  sign-of: func [     &quot;Returns sign of number as 1, 0, or -1 (to use as multiplier).&quot;     number [any-number! money! time!] ][     case [         positive? number [1]         negative? number [-1]         default [0]     ] ]  You could do this with an ELSE if you wished (I&#39;ve mentioned they are nearly the same, but not quite... a SWITCH/ALL will always run the default, but only run the ELSE if at least one branch runs):  case [     positive? n..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="1 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="1 ❤" />
<meta property="article:published_time" content="2019-09-30T11:32:29+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="https://forum.rebol.info/">
          <img src="../../uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" alt="AltRebol" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="1220.html">Stylistic Questions and Soft-Quoted Branching</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/usage/7" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #3AB54A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Usage</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/usage/show-and-tell/33" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #3AB54A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Show &amp; Tell</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='AltRebol'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="1220.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2019-09-30T11:32:29Z'>
              <time itemprop='dateModified' datetime='2019-09-30T14:01:32Z' class='post-time'>
                September 30, 2019,  2:01pm
              </time>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Here is a small implementation of SIGN-OF to look at:</p>
<pre><code>sign-of: func [
    "Returns sign of number as 1, 0, or -1 (to use as multiplier)."
    number [any-number! money! time!]
][
    case [
        positive? number [1]
        negative? number [-1]
        default [0]
    ]
]
</code></pre>
<p>You could do this with an ELSE if you wished (I've mentioned they are <em>nearly</em> the same, but not quite... a SWITCH/ALL will always run the default, but only run the ELSE if at least one branch runs):</p>
<pre><code>case [
    positive? number [1]
    negative? number [-1]
] else [0]
</code></pre>
<p>Moving in another direction: if we accept <a href="https://forum.rebol.info/t/soft-quoted-branching-light-elegant-fast/1020">soft-quoted branching</a> you could write the body as:</p>
<pre><code>case [
    positive? number '1
    negative? number '-1
    default '0
]
</code></pre>
<p>It can get even briefer if you understand the premise of <a href="../the-fallout-from-the-switch-fallout-feature/312.html">fallout</a> (which is why <a href="../default-now-usable-in-case-switch/739.html">DEFAULT can work here at all</a>).  You can omit the default.</p>
<pre><code>case [
    positive? number '1
    negative? number '-1
    '0
]
</code></pre>
<p>We're not really set up for performance analysis at this moment.  But if we talk about what ultimately will cost the least, that's the cheapest.  It's two series, one with 3 cells that will round up to a 4 cell pool (CASE, BLOCK!, terminator)...and one with 8 cells (WORD! WORD! QUOTED! WORD! WORD! QUOTED! QUOTED! terminator).  During CASE the evaluator creates basically one frame, which is reused.</p>
<p>By contrast, if you look at the original code at the top of the post with the 3 blocks for the branches, the evaluator does much more work.  Each block as a branch sets up a new frame and iteration.  This is not to mention the storage--which is more optimal in Ren-C (which can pack single element blocks into a series node vs. needing a dynamic allocation in addition to the series node...because it uses the space that <em>would</em> be tracking information for a dynamic allocation to store the cell itself).  But even so, each series node is still the size of two cells...and you need the cell to refer to it...and you're taxing the GC a bit more and losing locality.</p>
<h2>The Moral of the Story</h2>
<p><strong>I think the moral of the story is that soft-quoted branching should probably be here to stay.</strong>  It's an unusual idea, and you don't have to use it if you don't feel like it.  The biggest backwards compatibility issue on general use is that if you want a branch to be generated from code--or a variable--you have to put it in a GROUP! or somesuch:</p>
<pre><code> if condition (branch)  ; as opposed to `if condition branch`
 if condition :branch  ; this should probably work too
</code></pre>
<p>We <em>could</em> make it so that a single WORD! containing a BLOCK! were used, that it would accept it too.  I don't know how wise that is.  Certainly accepting an ACTION! would be weird:</p>
<pre><code> code: ["Hello" print]
 if condition reverse code
</code></pre>
<p>If that were allowed, then you'd get the equivalent of:</p>
<pre><code>code: ["Hello" print]
(if condition :reverse) code
</code></pre>
<p>e.g. if condition were truthy, it would call REVERSE on the condition...and then evaluate to code.  :-/  Anyway, I don't think having to put generated branches in a GROUP! is all that terrible--people are awfully used to putting ordinary branches in BLOCK!s...is it really so oppressive if the rarer case needs delimiters too?</p>
<p>The enhancements to COMPOSE really make this work well, I think:</p>
<pre><code> compose: [  ; Ren-C won't splice unless you say (( ))
      ...
      data: either condition '(thing1) '(thing2)
      ...
 ]
</code></pre>
<p>If you were to try and do that in R3-Alpha, how would you even go about it?</p>
<pre><code> compose/only/deep: [
      ...
      data: either condition [quote (thing1)] [quote (thing2)]
      ...
 ]
</code></pre>
<p>Even in the time when EITHER/ONLY was supported, you couldn't mix and match...both branches would be evaluated or both would be literal.  Soft-quoting gives you all options:</p>
<pre><code> &gt;&gt; either 1 &lt; 2 [print "code!"] '[data]
 code!

 &gt;&gt; either 1 &gt; 2 [print "code!] '[data]
 == [data]
</code></pre>
<p>So...while I've been looking at the concept with a critical eye during its inception period, I'm about to take it for granted.  If anyone who doesn't like soft-quoted branching (who hasn't drank the <a href="https://forum.rebol.info/t/quoted-arrives-formerly-known-as-lit-bit/995/2">Red Groupthink Kool-Aid</a> <img src="../../images/emoji/twitter/roll_eyes.png%3Fv=9" title=":roll_eyes:" class="emoji" alt=":roll_eyes:">), they should speak up now.</p>
        </div>

        <meta itemprop='headline' content='Stylistic Questions and Soft-Quoted Branching'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                    <a href="../the-canonical-list-of-non-negotiables/1244.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='https://forum.rebol.info/t/the-canonical-list-of-non-negotiables/1244'>
                      <span itemprop='name'>The Canonical List of Non-Negotiables</span>
                    </a>
                    <meta itemprop='position' content='5'>
                  </div>
            </div>
      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/categories' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/guidelines' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  
</html>
